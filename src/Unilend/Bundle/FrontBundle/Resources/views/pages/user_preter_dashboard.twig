{# User / Preter / Dashboard #}
{% extends 'layouts/_dashboard.twig' %}
{% import 'partials/common/_custom-input.macros.twig' as customInput %}

{# Page data #}
{% set bodyId = '' %}
{% set page = {
  id: 'user-preter-dashboard',
  title: 'Prêteur / Dashboard',
  permalink: route('user/preter/dashboard'),
  classNames: 'user-preter-dashboard'
} %}

{% block dashboardContent %}

  <div class="dashboard-panels-nav">
    <ul class="list-inline-block">{#
    #}<li role="presentation"><a href="#myaccount" class="dashboard-panel-toggle ui-dashboard-panel-hidden" data-toggle="ui">Mon compte</a></li>{#
    #}<li role="presentation"><a href="#userlevel" class="dashboard-panel-toggle ui-dashboard-panel-hidden" data-toggle="ui">Rendement de mon portefeuille</a></li>{#
    #}<li role="presentation"><a href="#mywallet" class="dashboard-panel-toggle ui-dashboard-panel-hidden" data-toggle="ui">Mon portefeuille</a></li>{#
    #}<li role="presentation"><a href="#myoffers" class="dashboard-panel-toggle ui-dashboard-panel-hidden" data-toggle="ui">Mes offres en cours</a></li>{#
    #}<li role="presentation"><a href="#projects" class="dashboard-panel-toggle ui-dashboard-panel-hidden" data-toggle="ui">Projets à découvrir</a></li>{#
    #}<li role="presentation"><a href="#myrembourse" class="dashboard-panel-toggle ui-dashboard-panel-hidden" data-toggle="ui">Mes remboursements</a></li>{#
    #}{# <li role="presentation"><a href="#autolend" class="dashboard-panel-toggle ui-dashboard-panel-hidden" data-toggle="ui">Autolend</a></li> #}{#
  #}</ul>
  </div>

  <section class="dashboard-panels-content" data-movable-content>

    {# Panel - My Account #}
    {% embed 'partials/components/dashboard-panel.twig' %}
      {% block panelAttributes %}id="myaccount" data-draggable{% endblock %}
      {% block panelClassNames %}dashboard-panel dashboard-myaccount col-lg-6 col-md-6 col-sm-8 col-xs-4{% endblock %}
      {% block panelTitle %}Mon compte{% endblock %}
      {% block panelContent %}
        <div class="dashboard-panel-overview">
          <div class="label">Votre solde</div>
          <div class="value">143,<sup>90€</sup></div>
        </div>
        <div class="dashboard-myaccount-chart dashboard-panel-chart">
          <div class="chart chart-myaccount">
            Custom chart @TODO
          </div>
          <div class="dashboard-panel-summary">
            <h3><span class="label">Gains attendus:</span> <span class="value">123€</span></h3>
          </div>
          <div class="dashboard-myaccount-chart-key">
            <div class="row">
              <div class="chart-key chart-key-prete col-lg-4 col-md-4 col-sm-4 col-xs-2">
                <div class="label">Montant prêté</div>
                <div class="value">252€</div>
              </div>
              <div class="chart-key chart-key-rembourse col-lg-4 col-md-4 col-sm-4 col-xs-2">
                <div class="label">Capital remboursé</div>
                <div class="value">52€</div>
              </div>
              <div class="chart-key chart-key-attente col-lg-4 col-md-4 col-sm-4 col-xs-2">
                <div class="label">Capital en attente</div>
                <div class="value">200€</div>
              </div>
              <div class="chart-key chart-key-recu col-lg-4 col-md-4 col-sm-4 col-xs-2">
                <div class="label">Intérêts reçus</div>
                <div class="value">18€</div>
              </div>
              <div class="chart-key chart-key-recevoir col-lg-4 col-md-4 col-sm-4 col-xs-2">
                <div class="label">Intérêts à recevoir</div>
                <div class="value">46€</div>
              </div>
              <div class="chart-key chart-key-difficulte col-lg-4 col-md-4 col-sm-4 col-xs-2">
                <div class="label">Capital en difficulté</div>
                <div class="value">5€</div>
              </div>
            </div>
          </div><!-- /.dashboard-myaccount-chart-key -->
        </div><!-- /.dashboard-myaccount-chart -->
      {% endblock %}
      {% block panelFooter %}
        <a href="#todo" class="link">Voir le detail de mes opérations</a>
      {% endblock %}
    {% endembed %}

    {# Panel - User Level #}
    {% embed 'partials/components/dashboard-panel.twig' %}
      {% block panelAttributes %}id="userlevel" data-draggable{% endblock %}
      {% block panelClassNames %}dashboard-panel dashboard-userlevel col-lg-6 col-md-6 col-sm-8 col-xs-4{% endblock %}
      {% block panelTitle %}Rendement de mon portefeuille{% endblock %}
      {% block panelContent %}
        <div class="dashboard-panel-overview">
          <div class="label">Votre taux de rendement</div>
          <div class="value">6,82<sup>%</sup></div>
        </div>
        <div class="dashboard-panel-chart">
          <div class="chart chart-userlevel">
            User Level avatar @TODO
          </div>
        </div>
        <div class="dashboard-panel-summary">
          <h3><span class="label">Niveau de diversification:</span> <span class="value">Débutant</span></h3>
          <p class="primary">Vous avez prêté à 54 emprunteurs.<br/>
          Répartissez vos prêts sur un plus grand nombre de projets pour réduire l’impact des impayés sur votre portefeuille.</p>
          <p class="secondary">Taux de rendement interne moyen Unilend : 5,40%</p>
        </div>
      {% endblock %}
      {% block panelFooter %}
        <a href="#todo" class="link">Optimiser mes performances</a>
      {% endblock %}
    {% endembed %}

    {# Panel - My Wallet #}
    {% embed 'partials/components/dashboard-panel.twig' %}
      {% block panelAttributes %}id="mywallet" data-draggable{% endblock %}
      {% block panelClassNames %}dashboard-panel dashboard-mywallet col-lg-12 col-md-12 col-sm-8 col-xs-4{% endblock %}
      {% block panelTitle %}Mon portefeuille (742 offres){% endblock %}
      {% block panelContent %}
        <div class="row tabs">
          <div class="dashboard-mywallet-nav col-lg-2 col-md-3 col-sm-8 col-xs-4">
            <ul class="nav nav-tabs-vertical">
              <li role="presentation" class="active"><a href="#mywallet-sectors" role="tab" data-toggle="tab">Répartition sectorielle</a></li>
              <li role="presentation"><a href="#mywallet-locations" role="tab" data-toggle="tab">Répartition géographique</a></li>
              <li role="presentation"><a href="#mywallet-account" role="tab" data-toggle="tab">Répartition de mon compte</a></li>
            </ul>
          </div><!-- /.dashboard-mywallet-nav -->
          <div class="dashboard-mywallet-content tab-content col-lg-10 col-md-9 col-sm-8 col-xs-4">
            <div id="mywallet-sectors" role="tabpanel" class="tab-pane active">
              <div class="row">
                <div class="col-info col-lg-3 col-md-4 col-sm-8 col-xs-4">
                  <h2>Alimentaire</h2>
                  <p>18% de mes prêts sont répartis dans ce secteur</p>
                  <dl>
                    <dt>Capital prêté</dt>
                    <dd>784€</dd>
                    <dt>Taux moyen</dt>
                    <dd>7,1%</dd>
                    <dt>Entreprises</dt>
                    <dd>12</dd>
                  </dl>
                </div><!-- /.col-info -->
                <div class="col-graph col-lg-9 col-md-8 col-sm-8 col-xs-4">
                  <div class="chart chart-treemap">
                    Highcharts Treemap @TODO
                  </div>
                </div><!-- /.col-graph -->
              </div>
            </div><!-- /#mywallet-sectors -->

            <div id="mywallet-locations" role="tabpanel" class="tab-pane">
              <p>Highcharts Map @TODO</p>
            </div><!-- /#mywallet-location -->

            <div id="mywallet-account" role="tabpanel" class="tab-pane">
              <p>Chart @TODO</p>
            </div><!-- /#mywallet-account -->
          </div><!-- /.dashboard-mywallet-content -->
        </div><!-- /.tabs -->
      {% endblock %}
    {% endembed %}

    {# Panel - My Offers in progress #}
    {% embed 'partials/components/dashboard-panel.twig' %}
      {% block panelAttributes %}id="myoffers" data-draggable{% endblock %}
      {% block panelClassNames %}dashboard-panel dashboard-myoffers col-lg-6 col-md-6 col-sm-8 col-xs-4{% endblock %}
      {% block panelTitle %}Mes offres en cours{% endblock %}
      {% block panelContent %}
        <div class="autolend">
          <div class="autolend-switch">
            {{ customInput.switch({
              id: 'autolend-enable',
              name: 'autolend-enable',
              isChecked: userProfile.autolend.enabled
            }) }}
            <label for="autolend-enable" class="autolend-switch-label">Activer Autolend</label>
          </div><!-- /.autolend-switch -->
          <div class="field-help">
            <div class="hide-md hide-lg">Connectez vous à votre espace depuis un ordinateur pour configurer vos offres Autolend</div>
            <div class="hide-xs hide-sm">Rendez-vous sur <a href="{{ route('user/preter/autolend') }}">votre espace Autolend</a> pour configurer les offres</div>
          </div><!-- /.field-help -->
        </div><!-- /.autolend -->
        <div class="message">
          <p>Vous avez actuellement 16 offres en cours</p>
        </div><!-- /.message -->
        <ul class="list-myoffers">
          {# Placeholder #}
          {% for i in 1..3 %}
          <li class="myoffer">
            <div class="myoffer-project-name">Garage Toniol</div>
            <div class="myoffer-project-cost">150&nbsp;000€</div>
            <div class="myoffer-project-period">7 jours restants</div>
            <div class="myoffer-amount">
              <span class="amount">450€</span> à <span class="interest">7,2%</span>
            </div>
          </li>
          <li class="myoffer myoffer-autolend">
            <div class="myoffer-project-name">Elevage bovin</div>
            <div class="myoffer-project-cost">150&nbsp;000€</div>
            <div class="myoffer-project-period">7 jours restants</div>
            <div class="myoffer-amount">
              Autolend: <span class="amount">45€</span> à <span class="interest">6,4%</span>
            </div>
          </li>
          {% endfor %}
        </ul><!-- /.list-myoffers -->
      {% endblock %}
      {% block panelFooter %}
        <a href="#todo" class="link">Voir toutes mes offres en cours</a>
      {% endblock %}
    {% endembed %}

    {# Panel - Projects to discover #}
    {% embed 'partials/components/dashboard-panel.twig' %}
      {% block panelAttributes %}id="projects" data-draggable{% endblock %}
      {% block panelClassNames %}dashboard-panel dashboard-projects col-lg-6 col-md-6 col-sm-8 col-xs-4{% endblock %}
      {% block panelTitle %}Projets à découvrir{% endblock %}
      {% block panelContent %}
        <div class="message">
          <p>12 nouveaux projets depuis votre dernière connexion</p>
        </div>
        <ul class="list-projects">
          {# Placeholder #}
          {% for i in 1..6 %}
          <li class="project">
            <div class="project-name">Garage Toniol</div>
            <div class="project-location">La Haie-Fouassière</div>
            <div class="project-cost">150&nbsp;000€</div>
            <div class="project-rating">
              <span class="rating rating-4-5"><span class="sr-only">Rated 4.5 out of 5</span></span>
            </div>
            <div class="project-interest">8,2%</div>
            <div class="project-period">7 jours restants</div>
            <div class="project-offers"><span class="value">117</span> offres</div>
            <a href="#todo" class="project-hotspot">&nbsp;</a>
          </li>
          {% endfor %}
        </ul>
      {% endblock %}
      {% block panelFooter %}
        <a href="#todo" class="link">Voir toutes mes offres en cours</a>
      {% endblock %}
    {% endembed %}

    {# Panel - My Remboursements #}
    {% embed 'partials/components/dashboard-panel.twig' %}
      {% block panelAttributes %}id="myrembourse" data-draggable{% endblock %}
      {% block panelClassNames %}dashboard-panel dashboard-myrembourse col-lg-12 col-md-12 col-sm-8 col-xs-4{% endblock %}
      {% block panelTitle %}Mes remboursements{% endblock %}
      {% block panelContent %}
        <div class="dashboard-panel-chart">
          <div class="chart chart-myremboursements">
            My remboursements chart @TODO
          </div>
        </div>
      {% endblock %}
    {% endembed %}

    {# Panel - Autolend (Mobile only) #}
    {# @note keeping it here just in case people change their minds #}
    {# {% embed 'partials/components/dashboard-panel.twig' %}
      {% block panelAttributes %}id="autolend" data-draggable{% endblock %}
      {% block panelClassNames %}dashboard-panel dashboard-autolend col-lg-6 col-md-6 col-sm-8 col-xs-4{% endblock %}
      {% block panelTitle %}Autolend{% endblock %}
      {% block panelControls %}
        {{ customInput.switch({
          id: 'autolend-enable',
          name: 'autolend-enable',
          isChecked: userProfile.autolend.enabled
        }) }}
        <a href="javascript:;" class="btn-close"><span class="sr-only">Close panel</span></a>
      {% endblock %}
      {% block panelContent %}
        <form class="form-panel-autolend" data-formvalidation data-formvalidation-render="false">
          <p>Saisissez un montant et un taux pour valider la fonctionnalité.</p>

          <div class="row row-multi-col">
            <div class="form-field col-lg-6 col-md-6 col-sm-4 col-xs-2">
              <div class="form-field-label">
                <label for="form-panel-autolend-amount">Montant à prêter <span class="field-required">*<span class="sr-only"> Required</span></span></label>
              </div><!-- /.form-field-label -->
              <div class="input-group set-left">
                <div class="btn-group">
                  <span class="icon fa-euro"></span>
                </div><!-- /.btn-group -->
                <input id="form-panel-autolend-amount" type="number" min="0" step="any" class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-render="true" />
              </div><!-- /.input-group -->
            </div><!-- /.form-field -->

            <div class="form-field col-lg-6 col-md-6 col-sm-4 col-xs-2">
              <div class="form-field-label">
                <label for="form-panel-autolend-interest">Taux minimum <span class="field-required">*<span class="sr-only"> Required</span></span></label>
              </div><!-- /.form-field-label -->
              <div class="input-group set-left">
                <div class="btn-group">
                  <span>%</span>
                </div><!-- /.btn-group -->
                <input id="form-panel-autolend-interest" type="number" min="0" max="10" step="0.1" class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-render="true" />
              </div><!-- /.input-group -->
            </div><!-- /.form-field -->
          </div><!-- /.row -->

          <div class="btn-controls">
            <button class="btn-primary btn-size-full">Valider</button>
          </div>

          <div class="ui-formvalidation-notifications">
            <p class="c-success"><span class="icon fa-check"></span> Paramètres enregistrés&nbsp;!</p>
          </div>

          <div class="field-help">
            <p>Connectez vous à votre espace prêteur depuis votre ordinateur pour configurer vos offres Autolend.</p>
          </div>
        </form><!-- /.form-panel-autolend -->
      {% endblock %}
    {% endembed %} #}

  </section>

{% endblock %}
