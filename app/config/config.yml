imports:
    - { resource: parameters.yml }
    - { resource: security.yml }
    - { resource: parameters_extended.yml, ignore_errors: true }

framework:
    secret: "%secret%"
    router:
        resource: "%kernel.root_dir%/config/routing.yml"
        strict_requirements: ~
    default_locale:  "%locale%"
    templating:
        engines: ['twig']
    assets:
        base_urls:
            - "%router.request_context.scheme%://%url.host_default%"
        packages:
            gulp:
                base_path: /assets
    translator:
        enabled: true
        fallbacks: ["fr_FR"]
        paths:
            - "%kernel.root_dir%/../src/Unilend/Bundle/TranslationBundle/Resources/translations"
        logging: true
    session:
        handler_id: null
        gc_maxlifetime: 3600
    csrf_protection: true
    form:
        csrf_protection:
            field_name: _csrf
    serializer:
      enabled: true

cmf_routing:
    chain:
        routers_by_id:
            router.default: 200
            cmf_routing.dynamic_router: 100
    dynamic:
        enabled: true
        default_controller: UnilendFrontBundle:Main:cms
        route_provider_service_id: "unilend.frontbundle.provider.route_provider"

twig:
    strict_variables: "%kernel.debug%"
    exception_controller:  UnilendFrontBundle:Exception:show
    paths:
        - "%kernel.root_dir%/Resources/views/frontbundle/"
    form_themes:
        - 'frontbundle/layouts/form_layout.html.twig'

doctrine:
    dbal:
        connections:
            default:
                driver:        "%database_driver%"
                host:          "%database_host%"
                port:          "%database_port%"
                dbname:        "%database_name%"
                user:          "%database_user%"
                password:      "%database_password%"
                charset:       "UTF8"
                wrapper_class: "%dbal_wrapper_class%"
                driver_class:  "%dbal_driver_class%"
                options:
                    x_reconnect_attempts: 3
    orm:
        result_cache_driver:
            type: memcache
            host: "%server1.memcache_host%"
            port: "%server1.memcache_port%"
            instance_class: Memcache
        query_cache_driver:
            type: memcache
            host: "%server1.memcache_host%"
            port: "%server1.memcache_port%"
            instance_class: Memcache

cache_adapter:
    providers:
        default_memcache_adapter:
            factory: 'cache.factory.memcache'
            options:
                host: "%server1.memcache_host%"
                port: "%server1.memcache_port%"
            aliases: ['memcache.default']

monolog:
    channels: [console]
    handlers:
        error:
            type: fingers_crossed
            action_level: error
            handler: error_handler
        error_handler:
            type: group
            members: [file_error]
#            members: [file_error, slack_error]
        file_error:
            type: rotating_file
            level: error
            path: "%kernel.logs_dir%/error.%kernel.environment%.log"
            max_files: 90
            date_format: 'Y-m-d'
            file_permission: 0664
#        slack_error:
#            type: slack
#            level: error
#            token: xoxb-54621264262-6EXEn7g59rpWe7vDxzHht5z5
#            channel: '#it-releases'
#            bot_name: 'Symfony Bot'

        console:
            type: fingers_crossed
            action_level: info
            handler: console_handler
        filter_console:
            type: filter
            handler: console
            max_level: warning
            channels: console
        console_handler:
            type: group
            members: [file_console, console_console]
        file_console:
            type: rotating_file
            path: "%kernel.logs_dir%/console.%kernel.environment%.log"
            level: info
            max_files: 90
            file_permission: 0664
            date_format: 'Y-m-d'
        console_console:
            type: console

        site:
            type: fingers_crossed
            action_level: info
            handler: site_handler
        filter_site:
            type: filter
            handler: site
            max_level: warning
            channels: !console
        site_handler:
            type: rotating_file
            level: info
            path: "%kernel.logs_dir%/site.%kernel.environment%.log"
            max_files: 90
            file_permission: 0664
            date_format: 'Y-m-d'

swiftmailer:
    transport: '%mailer_transport%'

unilend_translation:
    parameters:
        cache:
            path: "%kernel.cache_dir%/translations"

services:
    twig.extension.text:
        class: Twig_Extensions_Extension_Text
        tags:
            - { name: twig.extension }
    twig.extension.intl:
        class: Unilend\Bundle\FrontBundle\Twig\IntlExtension
        tags:
            - { name: twig.extension }

google_tag_manager:
    enabled: true
    id: "%gtm_token%"
    autoAppend: false

sonata_seo:
    encoding: UTF-8
    page:
        title: 'Unilend : les particuliers prêtent aux entreprises françaises'
        default: sonata.seo.page.default
        metas:
            name:
                keywords: 'Prêter Emprunter'
                description: 'Sur Unilend, tout le monde peut prêter aux entreprises françaises et recevoir des intérêts.'
                robots: 'index, follow'
                viewport: 'width=device-width, initial-scale=1'

            http-equiv:
                'Content-Type': 'text/html; charset=utf-8'
                'X-UA-Compatible': 'IE=edge,chrome=1;'

ekino_new_relic:
    enabled: false