{# User / Preter / Profile #}
{% extends 'layouts/_dashboard.twig' %}
{% import 'extensions/_general.macros.twig' as general %}
{% import 'partials/common/_custom-input.macros.twig' as customInput %}

{# Page data #}
{% set bodyId = '' %}
{% set page = {
  id: 'user-preter-profile',
  title: 'Prêteur / Profil',
  permalink: route('user/preter/profile'),
  classNames: 'user-preter-profile'
} %}

{# See config/twig.json for the data value of `userProfile` #}
{# @todo Update the edited input output variables with what was saved (should be in an AJAX call) #}

{% block dashboardContent %}

  <div class="dashboard-tabs tabs">
    <div class="dashboard-tabs-nav">
      <ul class="nav nav-dashboard-tabs" data-nav-dropdown-menu="mobile">{#
      #}<li role="presentation" class="active"><a href="#profile-info" role="tab" data-toggle="tab">Informations personnelles</a></li>{#
      #}<li role="presentation"><a href="#profile-fiscalite" role="tab" data-toggle="tab">Informations fiscales</a></li>{#
      #}<li role="presentation"><a href="#profile-security" role="tab" data-toggle="tab">Securité</a></li>{#
      #}<li role="presentation"><a href="#profile-alerts" role="tab" data-toggle="tab">Alertes</a></li>{#
    #}</ul>
    </div><!-- /.dashboard-nav-content -->

    <div class="dashboard-tabs-content tab-content">

      <div id="profile-info" role="tabpanel" class="dashboard-tab-pane tab-pane active">
        <article id="panel-info" class="panel">
          <header class="panel-header">
            <h3>Mon identité</h3>
          </header>
          <section id="profile-info-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
            <section id="profile-info-view" role="tabpanel" class="profile-info-view collapse in">
              <a href="#profile-info-edit" role="button" data-toggle="collapse" data-parent="#profile-info-section" class="btn-edit" aria-controls="#profile-info-edit" aria-expanded="false"><span class="icon fa-pencil-u32"></span> <span class="label">Modifier</span></a>
              <dl class="list-2col">
                <dt>Statut</dt>
                <dd id="profile-info-statut-output">{{ userProfile.identity.statutLabel }}</dd>
                <dt>Civilité</dt>
                <dd id="profile-info-civilite-output">{{ userProfile.identity.civiliteLabel }}</dd>
                <dt>Nom</dt>
                <dd id="profile-info-nom-output">{{ userProfile.identity.nom }}</dd>
                <dt>Prénom</dt>
                <dd id="profile-info-prenom-output">{{ userProfile.identity.prenom }}</dd>
                <dt>Date de naissance</dt>
                <dd id="profile-info-dob-output">{{ userProfile.identity.dob.full }}</dd>
                <dt>Pays de naissance</dt>
                <dd id="profile-info-dob-pays-output">{{ userProfile.identity.dob.paysLabel }}</dd>
                <dt>Commune de naissance</dt>
                <dd id="profile-info-dob-commune-output">{{ userProfile.identity.dob.commune }}</dd>
                <dt>Nationalité</dt>
                <dd id="profile-info-dob-nationalite-output">{{ userProfile.identity.dob.nationaliteLabel }}</dd>
                <dt>Pièce d'identité</dt>
                <dd id="profile-info-fichier-identitie-output">
                  <span id="form-profile-info-file-identite-cni-1-output" class="file-justificatif file-identity-side-a" title="Carte d'identié fournie le 03/01/2016" data-toggle="tooltip">
                    <span class="sr-only">Carte d'identité fournie le 03/01/2016</span>
                  </span>
                  <span id="form-profile-info-file-identite-cni-2-output" class="file-justificatif file-identity-side-b" title="Carte d'identié fournie le 03/01/2016" data-toggle="tooltip">
                    <span class="sr-only">Carte d'identité fournie le 03/01/2016</span>
                  </span>
                </dd>
              </dl>
            </section>

            <section id="profile-info-edit" role="tabpanel" class="profile-info-edit collapse">
              <form id="form-profile-info-edit" action="{{ route('user/preter/profile/info/update') }}" method="post" class="form-profile form-profile-info-edit" data-formvalidation data-formvalidation-notificationselem="#form-profile-info-notifications">
                <div id="form-profile-info-notifications"></div>
                <div class="row">
                  <div class="form-field form-field-multi">
                    <div class="field-label">
                      <label>Statut <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    </div>
                    <ul class="list-input-values" data-formvalidation-input data-formvalidation-required="true">
                      <li>
                        <label><input type="radio" name="identity[statut]" value="particulier" {% if userProfile.identity.statut == 'particulier' %}checked="checked"{% endif %}/> Particulier</label>
                      </li>
                      <li>
                        <label><input type="radio" name="identity[statut]" value="societe" {% if userProfile.identity.statut == 'societe' %}checked="checked"{% endif %}/> Société soumise à l'IS</label>
                      </li>
                    </ul>
                  </div><!-- /.form-field -->
                </div><!-- /.row -->

                <div class="row">
                  <div class="form-field form-field-multi">
                    <div class="field-label">
                      <label>Civilité <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    </div>
                    <ul class="list-input-values" data-formvalidation-input data-formvalidation-required="true">
                      <li>
                        <label><input type="radio" name="identity[civilite]" value="madame" {% if userProfile.identity.civilite == 'madame' %}checked="checked"{% endif %}/> Madame</label>
                      </li>
                      <li>
                        <label><input type="radio" name="identity[civilite]" value="monsieur" {% if userProfile.identity.civilite == 'monsieur' %}checked="checked"{% endif %}/> Monsieur</label>
                      </li>
                    </ul>
                  </div><!-- /.form-field -->
                </div><!-- /.row -->

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-info-nom">Nom <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-info-nom" type="text" name="identity[nom]" value="{{ userProfile.identity.nom }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-info-prenom">Prénom <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-info-prenom" type="text" name="identity[prenom]" value="{{ userProfile.identity.prenom }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                </div><!-- /.row -->

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label>Date de naissance <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <select name="identity[dob][day]" class="input-field input-field-short" data-formvalidation-input data-formvalidation-required="true">
                      {{ general.selectDayOptions(userProfile.identity.dob.day) }}
                    </select> <select name="identity[dob][month]" class="input-field input-field-short" data-formvalidation-input data-formvalidation-required="true">
                      {{ general.selectMonthOptions(userProfile.identity.dob.month) }}
                    </select> <select name="identity[dob][year]" class="input-field input-field-short" data-formvalidation-input data-formvalidation-required="true">
                      {{ general.selectYearOptions(userProfile.identity.dob.year) }}
                    </select>
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-info-nationalite">Nationalité <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <select id="form-profile-info-nationalite" name="identity[nationalite]" class="input-field" data-formvalidation-input data-formvalidation-required="true">
                      {{ general.selectNationalityOptions(userProfile.identity.dob.nationalite) }}
                    </select>
                  </div><!-- /.form-field -->
                </div><!-- /.row -->

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-info-dob-pays">Pays de naissance <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <select id="form-profile-info-dob-pays" name="identity[dob][pays]" class="input-field" data-formvalidation-input data-formvalidation-required="true">
                      {{ general.selectCountryCodeOptions(userProfile.identity.dob.pays) }}
                    </select>
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-info-dob-commune">Commune de naissance <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-info-dob-commune" type="text" name="identity[dob][commune]" value="{{ userProfile.identity.dob.commune }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                </div><!-- /.row -->

                <div class="row">
                  <div class="form-field">
                    <label>Pièce d'identité <span class="field-required">*<span class="sr-only"> Required</span></span></label>

                    <div class="form-field file-identity-side-a">
                      <div class="custom-input-file" id="form-profile-info-file-identite-cni-1" data-fileattach data-fileattach-inputname="fichier[identite][cni_a]" data-fileattach-maxfiles="1" data-fileattach-emptyfilelabel="CNI recto / page 2 du passeport" data-fileattach-files='{{ userProfile.fichier.identite.cni_a|default([])|json_encode }}' data-formvalidation-input data-formvalidation-required='input[type="file"][name="fichier[identite][cni_a][0]"]'></div><!-- /.ui-fileattach -->
                    </div>

                    <div class="form-field file-identity-side-b">
                      <div class="custom-input-file" id="form-profile-info-file-identite-cni-2" data-fileattach data-fileattach-inputname="fichier[identite][cni_b]" data-fileattach-maxfiles="1" data-fileattach-emptyfilelabel="CNI verso / page 3 du passeport" data-fileattach-files='{{ userProfile.fichier.identite.cni_b|default([])|json_encode }}' data-formvalidation-input data-formvalidation-required='input[type="file"][name="fichier[identite][cni_b][0]"]'></div><!-- /.ui-fileattach -->
                    </div>

                    <div class="field-help">
                      <p>Copie recto-verso de la CNI ou double page 2 et 3 du passeport</p>
                    </div>

                    <div class="form-field">
                      <div class="custom-input-file" id="form-profile-info-file-identite-extra" data-fileattach data-fileattach-inputname="fichier[identite][extra]" data-fileattach-maxfiles="5" data-fileattach-files='{{ userProfile.fichier.identite.extra|default([])|json_encode }}'></div><!-- /.ui-fileattach -->
                    </div>
                  </div>
                </div>

                <div class="btn-controls">
                  <button type="submit" class="btn-primary">Enregister</button>
                  <button type="reset" role="button" data-toggle="collapse" data-target="#profile-info-view" data-parent="#profile-info-section" class="btn-default" aria-controls="#profile-info-view" aria-expanded="true">Annuler l'édition</button>
                </div>
              </form><!-- /.form-profile-info-edit -->
            </section><!-- /.profile-info-edit -->
          </section><!-- /.ui-toggle-group -->
        </article><!-- /.panel -->

        <article id="panel-address" class="panel">
          <header class="panel-header">
            <h3>Mon adresse fiscale</h3>
            <div id="profile-address-is-correspondence" class="{% if userProfile.identity.address.is_correspondence != true %}hide{% endif %}"><span class="icon fa-check-u32"></span> Adresse de correspondance identique</div>
          </header>
          <section id="profile-address-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
            <section id="profile-address-view" role="tabpanel" class="profile-address-view collapse in">
              <a href="#profile-address-edit" role="button" data-toggle="collapse" data-parent="#profile-address-section" class="btn-edit" aria-controls="#profile-address-edit" aria-expanded="false"><span class="icon fa-pencil-u32"></span> <span class="label">Modifier</span></a>
              <dl class="list-2col">
                <dt>Adresse</dt>
                <dd id="profile-address-street-output">{{ userProfile.identity.address.street }}</dd>
                <dt>Code postal</dt>
                <dd id="profile-address-code-output">{{ userProfile.identity.address.code }}</dd>
                <dt>Ville</dt>
                <dd id="profile-address-ville-output">{{ userProfile.identity.address.ville }}</dd>
                <dt>Pays</dt>
                <dd id="profile-address-pays-output">{{ userProfile.identity.address.paysLabel }}</dd>
                <dt>Téléphone mobile</dt>
                <dd id="profile-address-mobile-output">{{ userProfile.identity.address.mobile }}</dd>
                <dt>Justificatifs</dt>
                <dd id="profile-address-fichier-domicile-output">
                  <span id="form-profile-address-file-domicile-1-output" class="file-justificatif file-domicile" title="Bilan fournie le 03/01/2016" data-toggle="tooltip">
                    <span class="sr-only">Bilan fournie le 03/01/2016</span>
                  </span>
                </dd>
              </dl>
            </section><!-- /.profile-address-view -->

            <section id="profile-address-edit" role="tabpanel" class="profile-address-edit collapse">
              <form id="form-profile-address-edit" action="{{ route('user/preter/profile/address/update') }}" method="post" class="form-profile form-profile-address-edit" data-formvalidation data-formvalidation-notificationselem="#form-profile-address-notifications">
                <div id="form-profile-address-notifications"></div>
                <div class="row">
                  <div class="form-field">
                    <label for="form-profile-address-street">Adresse fiscale <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-address-street" type="text" name="identity[address][street]" value="{{ userProfile.identity.address.street }}" class="input-field" placeholder="Addresse utilisée pour vos avis d'imposition" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                </div>

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-address-code">Code postale <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-code" type="text" name="identity[address][code]" value="{{ userProfile.identity.address.code }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-address-ville">Ville <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-address-ville" type="text" name="identity[address][ville]" value="{{ userProfile.identity.address.ville }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                </div>

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-address-pays">Pays <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <select id="form-profile-address-pays" name="identity[address][pays]" class="input-field" data-formvalidation-input data-formvalidation-required="true">
                      {{ general.selectCountryCodeOptions(userProfile.identity.address.pays) }}
                    </select>
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-address-mobile">Téléphone mobile <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="input-group"><input id="form-profile-address-mobile" type="text" name="identity[address][mobile]" value="{{ userProfile.identity.address.mobile }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-type="telephone" /></div>
                  </div><!-- /.form-field -->
                </div>

                <div class="row">
                  <div class="form-field form-field-single-checkbox">
                    <label><input id="form-profile-address-is-correspondence" type="checkbox" name="identity[address][is_correspondence]" value="true" {% if userProfile.identity.address.is_correspondence == true %}checked="checked"{% endif %}> <span class="label">Adresse de correspondence identique</span></label>
                  </div><!-- /.form-field -->
                </div>

                <div class="row">
                  <div class="form-field">
                    <label>Justificatifs de domicile <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="custom-input-file" id="form-profile-info-file-domicile" data-fileattach data-fileattach-inputname="fichier[domicile]" data-fileattach-maxfiles="5" data-fileattach-files='{{ userProfile.fichier.domicile|default([])|json_encode }}'></div><!-- /.ui-fileattach -->
                  </div>
                </div>

                <div class="btn-controls">
                  <button class="btn-primary">Enregister</button>
                  <button type="reset" role="button" data-toggle="collapse" data-target="#profile-address-view" data-parent="#profile-address-section" class="btn-default" aria-controls="#profile-address-view" aria-expanded="true">Annuler l'édition</button>
                </div><!-- /.btn-controls -->
              </form><!-- /.form-profile-address-edit -->
            </section><!-- /.profile-address-edit -->
          </section><!-- /.ui-toggle-group -->
        </article><!-- /.panel -->

        {# Address Correspondence #}
        <article id="panel-correspondence" class="panel collapse{% if userProfile.identity.address.is_correspondence != true %} in{% endif %}">
          <header class="panel-header">
            <h3>Mon adresse correspondence</h3>
          </header>
          <section id="profile-correspondence-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
            <section id="profile-correspondence-view" role="tabpanel" class="profile-correspondence-view collapse in">
              <a href="#profile-correspondence-edit" role="button" data-toggle="collapse" data-parent="#profile-correspondence-section" class="btn-edit" aria-controls="#profile-correspondence-edit" aria-expanded="false"><span class="icon fa-pencil-u32"></span> <span class="label">Modifier</span></a>
              <dl class="list-2col">
                <dt>Adresse</dt>
                <dd id="profile-correspondence-street-output">{{ userProfile.identity.correspondence.street|default(userProfile.identity.address.street) }}</dd>
                <dt>Code postal</dt>
                <dd id="profile-correspondence-code-output">{{ userProfile.identity.correspondence.code|default(userProfile.identity.address.code) }}</dd>
                <dt>Ville</dt>
                <dd id="profile-correspondence-ville-output">{{ userProfile.identity.correspondence.ville|default(userProfile.identity.address.ville) }}</dd>
                <dt>Pays</dt>
                <dd id="profile-correspondence-pays-output">{{ userProfile.identity.correspondence.paysLabel|default(userProfile.identity.address.paysLabel) }}</dd>
                <dt>Téléphone mobile</dt>
                <dd id="profile-correspondence-telephone-output">{{ userProfile.identity.correspondence.mobile|default(userProfile.identity.address.mobile) }}</dd>
              </dl>
            </section><!-- /.profile-correspondence-view -->

            <section id="profile-correspondence-edit" role="tabpanel" class="profile-correspondence-edit collapse">
              <form id="form-profile-correspondence-edit" action="{{ route('user/preter/profile/correspondence/update') }}" method="post" class="form-profile form-profile-correspondence-edit" data-formvalidation data-formvalidation-notificationselem="#form-profile-correspondence-notifications">
                <div id="form-profile-correspondence-notifications"></div>
                <div class="row">
                  <div class="form-field">
                    <label for="form-profile-correspondence-street">Adresse <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-correspondence-street" type="text" name="identity[correspondence][street]" value="{{ userProfile.identity.correspondence.street|default(userProfile.identity.address.street) }}" class="input-field" placeholder="Addresse utilisée pour vos avis d'imposition" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                </div>

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-correspondence-code">Code postale <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-correspondence-code" type="text" name="identity[correspondence][code]" value="{{ userProfile.identity.correspondence.code|default(userProfile.identity.address.code) }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-correspondence-ville">Ville <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-correspondence-ville" type="text" name="identity[correspondence][ville]" value="{{ userProfile.identity.correspondence.ville|default(userProfile.identity.address.ville) }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                  </div><!-- /.form-field -->
                </div>

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-correspondence-pays">Pays <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <select id="form-profile-correspondence-pays" name="identity[correspondence][pays]" class="input-field" data-formvalidation-input data-formvalidation-required="true">
                      {{ general.selectCountryCodeOptions(userProfile.identity.correspondence.pays|default(userProfile.identity.address.pays)) }}
                    </select>
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-correspondence-mobile">Téléphone mobile <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="input-group"><input id="form-profile-correspondence-mobile" type="text" name="identity[correspondence][mobile]" value="{{ userProfile.identity.correspondence.mobile|default(userProfile.identity.address.mobile) }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-type="telephone" /></div>
                  </div><!-- /.form-field -->
                </div>

                <div class="btn-controls">
                  <button class="btn-primary">Enregister</button>
                  <button type="reset" role="button" data-toggle="collapse" data-target="#profile-correspondence-view" data-parent="#profile-correspondence-section" class="btn-default" aria-controls="#profile-correspondence-view" aria-expanded="true">Annuler l'édition</button>
                </div><!-- /.btn-controls -->
              </form><!-- /.form-profile-correspondence-edit -->
            </section><!-- /.profile-correspondence-edit -->
          </section><!-- /.ui-toggle-group -->
        </article><!-- /.panel -->

      </div><!-- /#profile-info.dashboard-tab-pane -->

      <div id="profile-fiscalite" role="tabpanel" class="dashboard-tab-pane tab-pane">
        <article id="panel-bank" class="panel">
          <header class="panel-header">
            <h3>Mes informations bancaires</h3>
          </header><!-- .panel-header -->
          <section id="profile-fiscalite-bank-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
            <section id="profile-fiscalite-bank-view" role="tabpanel" class="profile-bank-view collapse in">
              <a href="#profile-fiscalite-bank-edit" role="button" data-toggle="collapse" data-parent="#profile-fiscalite-bank-section" class="btn-edit" aria-controls="#profile-fiscalite-bank-edit" aria-expanded="false"><span class="icon fa-pencil-u32"></span> <span class="label">Modifier</span></a>
              <dl class="list-2col">
                <dt>Origine des fonds</dt>
                <dd id="profile-fiscalite-bank-origin-output">{{ userProfile.fiscalite.bank.origin }}</dd>
                <dt>BIC</dt>
                <dd id="profile-fiscalite-bank-bic-output">{{ userProfile.fiscalite.bank.bic }}</dd>
                <dt>IBAN</dt>
                <dd id="profile-fiscalite-bank-iban-output">{{ userProfile.fiscalite.bank.iban }}</dd>
                <dt>Jusitificatifs</dt>
                <dd id="profile-fiscalite-bank-fichier-rib-output">
                  <span id="form-fiscalite-bank-file-rib-1-output" class="file-justificatif file-rib" title="RIB fournie le 03/01/2016" data-toggle="tooltip">
                    <span class="sr-only">RIB fournie le 03/01/2016</span>
                  </span>
                </dd>
              </dl>
            </section>

            <section id="profile-fiscalite-bank-edit" role="tabpanel" class="profile-fiscalite-bank-view collapse">
              <form id="form-profile-fiscalite-bank-edit" action="{{ route('user/preter/profile/bank/update') }}" method="post" class="form-fiscalite form-profile-fiscalite-bank-edit" data-formvalidation data-formvalidation-notificationselem="#form-profile-fiscalite-bank-notifications">
                <div id="form-profile-fiscalite-bank-notifications"></div>

                <div class="row">
                  <div class="form-field form-field-iban">
                    <div id="form-profile-fiscalite-iban-add" data-toggle-group="iban" class="ui-toggle iban-add">
                      {# <div class="message-info">
                        <p>Indiquez le RIB sur lequel vous purrez récupérer facilement votre argent récolté sur Unilend. Vous seul pouvez faire des mouvements sur ce compte bancaire.</p>
                      </div><!-- /.message-info --> #}

                      <label for="form-profile-fiscalite-iban" class="form-field-label">IBAN <span class="field-required">*<span class="sr-only"> Required</span></span></label>

                      <div class="input-group">
                        <div class="custom-input-iban">
                          {# @TODO Remove the preset value for production #}
                          <input id="form-profile-fiscalite-iban" type="text" name="iban" value="FR76 3000 4021 1800 0406 3100 792" class="iban-input input-field" data-formvalidation-input data-formvalidation-type="iban" />
                        </div>
                      </div><!-- /.input-group -->

                      <ul class="ui-formvalidation-messages"></ul>

                      <p><a href="#form-profile-fiscalite-iban-info" class="btn-primary">Ajouter</a></p>
                    </div><!-- /.iban-add -->
                    <div id="form-profile-fiscalite-iban-info" data-toggle-group="iban" class="ui-toggle iban-info" style="display: none">
                      <div class="iban-info-details">
                        <div class="row">
                          <div class="col-lg-6 col-md-6">
                            <label>IBAN</label>
                            <p>FR20 2524 1200 0127 3242 5P01 025</p>
                          </div>
                          <div class="col-lg-6 col-md-6">
                            <label>BIC</label>
                            <p>PSSTFRPPPAR</p>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-lg-6 col-md-6">
                            <label>Titulaire du compte</label>
                            <p>David Raux<br/>
                            27 avenue des Champs-Elysées<br/>
                            75008 Paris France</p>
                          </div>
                          <div class="col-lg-6 col-md-6">
                            <label>Nom de la banque</label>
                            <p>La Banque Postale</p>
                          </div>
                        </div>
                      </div>
                      <p><a href="#form-profile-fiscalite-iban-add" class="btn-primary">Modifier</a></p>
                    </div><!-- /.iban-info -->
                  </div><!-- /.form-field -->
                </div>

                <div class="row">
                  <div class="form-field">
                    <label>Justificatifs de RIB <span class="field-required">*<span class="sr-only"> Required</span></span></label>

                    <div class="form-field file-rib">
                      <div class="custom-input-file" id="form-profile-fiscalite-bank-file-rib" data-fileattach data-fileattach-inputname="fichier[rib]" data-fileattach-maxfiles="1" data-fileattach-emptyfilelabel="RIB" data-fileattach-files='{{ userProfile.fichier.rib|default([])|json_encode }}' data-formvalidation-input data-formvalidation-required='input[type="file"][name="fichier[rib][0]"]'></div><!-- /.ui-fileattach -->
                    </div>
                  </div><!-- /.form-field -->
                </div>

                <div class="btn-controls">
                  <button class="btn-primary">Enregister</button>
                  <button type="reset" role="button" data-toggle="collapse" data-target="#profile-fiscalite-bank-view" data-parent="#profile-fiscalite-bank-section" class="btn-default" aria-controls="#profile-fiscalite-bank-view" aria-expanded="true">Annuler l'édition</button>
                </div><!-- /.btn-controls -->
              </form><!-- /.form-bank-edit -->
            </section><!-- /#profile-fiscalite-bank-edit -->
          </section><!-- /.ui-toggle-group -->
        </article><!-- /.panel -->

        <article id="panel-reports" class="panel">
          <header class="panel-header">
            <h3>Mes documents fiscaux</h3>
          </header><!-- .panel-header -->
          {% if userProfile.fiscalite.reports is not empty %}
          <div class="panel-content">
            <ul class="list-files">
              {% for i, file in userProfile.fiscalite.reports %}
              <li class="file file-type-{{ file.type }}">
                <p><strong>{{ file.label }}</strong><br/>
                  Imprimé fiscal unique<br/>
                <a href="{{ item.url }}" target="_blank" class="link">Télécharger</a></p>
              </li>
              {% endfor %}
            </ul><!-- /.list-files -->
          </div><!-- /.panel-content -->
          {% endif %}
          <div class="panel-content">
            <p>Si vous êtes éligible à l'impôt de Solidarité sur la Fortune (ISF), il est de votre responsabilité de déclarer votre patrimoine à l'administration fiscale. Afin de réaliser votre déclaration relative à l'ISF 2016, retrouvez ci-dessous les informations sur votre situation au 31 décembre 2015:</p>
            <dl class="list-2col">
              <dt>Solde à déclarer</dt>
              <dd>{{ userProfile.fiscalite.balance|__price(2)|nbsp }}€</dd>
              <dt>Capital restant dû</dt>
              <dd>{{ userProfile.fiscalite.capital|__price(2)|nbsp }}€</dd>
            </dl>
          </div><!-- /.panel-content -->
        </article><!-- /#panel-reports.panel -->
      </div><!-- /#profile-fiscalite.dashboard-tab-pane -->

      {# SECURITY #}
      <div id="profile-security" role="tabpanel" class="dashboard-tab-pane tab-pane">
        {# IDENTIFICATION #}
        <article id="panel-identification" class="panel">
          <header class="panel-header">
            <h3>Identification</h3>
          </header><!-- .panel-header -->
          <section id="profile-security-identification-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
            <section id="profile-security-identification-view" role="tabpanel" class="profile-security-identification-view collapse in">
              <a href="#profile-security-identification-edit" role="button" data-toggle="collapse" data-parent="#profile-security-identification-section" class="btn-edit" aria-controls="#profile-security-identification-edit" aria-expanded="false"><span class="icon fa-pencil-u32"></span> <span class="label">Modifier</span></a>
              <dl class="list-2col">
                <dt>E-mail</dt>
                <dd id="profile-security-identification-email-output">{{ userProfile.access.email }}</dd>
                <dt>Téléphone mobile</dt>
                <dd id="profile-security-identification-mobile-output">{{ userProfile.access.mobile }}</dd>
                <dt>Téléphone fixe</dt>
                <dd id="profile-security-identification-telephone-output">{{ userProfile.access.telephone }}</dd>
              </dl>
            </section>

            <section id="profile-security-identification-edit" role="tabpanel" class="profile-security-identification-view collapse">
              <form id="form-profile-security-identification-edit" action="{{ route('user/preter/profile/identification/update') }}" method="post" class="form-security form-profile-security-identification-edit" data-formvalidation data-formvalidation-notificationselem="#form-profile-security-identification-notifications">
                <div id="form-profile-security-identification-notifications"></div>

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-security-identification-email">E-mail <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="input-group">
                      <input id="form-profile-security-identification-email" type="email" name="identity[email]" value="{{ userProfile.access.email|escape('html_attr') }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                    </div>
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-security-identification-email-conf">Confirmation e-mail <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="input-group">
                      <input id="form-profile-security-identification-email-conf" type="email" name="identity[email_conf]" value="" class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-samevalueas="#form-profile-security-identification-email" />
                    </div>
                  </div><!-- /.form-field -->
                </div>

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-security-identification-mobile">Téléphone mobile <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="input-group"><input id="form-profile-security-identification-mobile" type="text" name="identity[mobile]" value="{{ userProfile.access.mobile|escape('html_attr') }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-type="telephone" /></div>
                  </div><!-- /.form-field -->
                  {# Not sure why they want the fixed telephone here and not in the address #}
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-security-identification-telephone">Téléphone fixe <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="input-group"><input id="form-profile-security-identification-telephone" type="text" name="identity[telephone]" value="{{ userProfile.access.telephone|escape('html_attr') }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-type="telephone" /></div>
                  </div><!-- /.form-field -->
                </div>

                <div class="btn-controls">
                  <button class="btn-primary">Enregister</button>
                  <button type="reset" role="button" data-toggle="collapse" data-target="#profile-security-identification-view" data-parent="#profile-security-identification-section" class="btn-default" aria-controls="#profile-security-identification-view" aria-expanded="true">Annuler l'édition</button>
                </div><!-- /.btn-controls -->
              </form><!-- /.form-security-identification-edit -->
            </section><!-- /#profile-security-identification-edit -->
          </section><!-- /.ui-toggle-group -->
        </article><!-- /.panel -->

        {# PASSWORD #}
        <article id="panel-password" class="panel">
          <header class="panel-header">
            <h3>Mot de passe</h3>
          </header><!-- .panel-header -->
          <section id="profile-security-password-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
            <section id="profile-security-password-view" role="tabpanel" class="profile-security-password-view collapse in">
              <a href="#profile-security-password-edit" role="button" data-toggle="collapse" data-parent="#profile-security-password-section" class="btn-edit" aria-controls="#profile-security-password-edit" aria-expanded="false"><span class="icon fa-pencil-u32"></span> <span class="label">Changer mon mot de passe</span></a>
              <dl class="list-2col">
                <dt>Mot de passe</dt>
                <dd>************</dd>
              </dl>
            </section>

            <section id="profile-security-password-edit" role="tabpanel" class="profile-security-password-view collapse">
              <form id="form-profile-security-password-edit" action="{{ route('user/preter/profile/password/update') }}" method="post" class="form-security form-profile-security-password-edit" data-formvalidation data-formvalidation-notificationselem="#form-profile-security-password-notifications">
                <div id="form-profile-security-password-notifications"></div>

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-security-password-passe">Ancien mot de passe <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="input-group">
                      <input id="form-profile-security-password-passe" type="password" name="access[passe]" value="" class="input-field" data-formvalidation-input data-formvalidation-required="true" />
                    </div><!-- /.input-group -->
                    <ul class="ui-formvalidation-messages"></ul>
                    <div class="field-help">
                      <a href="{{ route('user/access/forgotpassword') }}" class="link">Mot de passe oublié?</a>
                    </div>
                  </div><!-- /.form-field -->
                </div>

                <div class="row row-multi-col-computer">
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-security-password-passe-new">Nouveau mot de passe <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input id="form-profile-security-password-passe-new" type="password" name="identity[passe]" value="" class="input-field" data-passwordcheck data-formvalidation-input data-formvalidation-required="true" data-formvalidation-minlength="8" />
                  </div><!-- /.form-field -->
                  <div class="form-field col-lg-6 col-md-6">
                    <label for="form-profile-security-password-passe-new-conf">Confirmation du nouveau mot de passe <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <div class="input-group"><input id="form-profile-security-password-passe-new-conf" type="password" name="identity[passe_conf]" value="" class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-samevalueas="#form-profile-security-password-passe-new" /></div>
                  </div><!-- /.form-field -->
                </div>

                <div class="btn-controls">
                  <button class="btn-primary">Enregister</button>
                  <button type="reset" role="button" data-toggle="collapse" data-target="#profile-security-password-view" data-parent="#profile-security-password-section" class="btn-default" aria-controls="#profile-security-password-view" aria-expanded="true">Annuler l'édition</button>
                </div><!-- /.btn-controls -->
              </form><!-- /.form-security-password-edit -->
            </section><!-- /#profile-security-password-edit -->
          </section><!-- /.ui-toggle-group -->
        </article><!-- /.panel -->

        {# SECURITY QUESTION #}
        <article id="panel-question" class="panel">
          <header class="panel-header">
            <h3>Question secrète</h3>
          </header><!-- .panel-header -->
          <p>Cette question vous sera posée dans le cas où vous auriez oublié votre mot de passe.</p>
          <section id="profile-security-question-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
            <section id="profile-security-question-view" role="tabpanel" class="profile-security-question-view collapse in">
              <a href="#profile-security-question-edit" role="button" data-toggle="collapse" data-parent="#profile-security-question-section" class="btn-edit" aria-controls="#profile-security-question-edit" aria-expanded="false"><span class="icon fa-pencil-u32"></span> <span class="label">Modifier</span></a>
            </section>

            <section id="profile-security-question-edit" role="tabpanel" class="profile-security-question-view collapse">
              <form id="form-profile-security-question-edit" action="{{ route('user/preter/profile/question/update') }}" method="post" class="form-security form-profile-security-question-edit" data-formvalidation data-formvalidation-notificationselem="#form-profile-security-question-notifications">
                <div id="form-profile-security-question-notifications"></div>

                <div class="row">
                  <div class="form-field">
                    <label for="form-profile-security-question-q">Séléctionnez une question secrète <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <select id="form-profile-security-question-q" name="access[question][q]" class="input-field" data-formvalidation-input data-formvalidation-required="true">
                      <option>Quel était le nom de mon premier animal de compagnie?</option>
                      {# @todo More questions to go here? #}
                    </select>
                  </div><!-- /.form-field -->
                </div>

                <div class="row">
                  <div class="form-field">
                    <label for="form-profile-security-question-a">Saisissez la réponse à cette question secrète <span class="field-required">*<span class="sr-only"> Required</span></span></label>
                    <input type="text" id="form-profile-security-question-a" name="access[question][a]" value="{{ userProfile.access.question.a|escape('html_attr') }}" class="input-field" data-formvalidation-input data-formvalidation-required="true" value="{{ userProfile.access.question[a]|escape('html_attr') }}" />
                  </div><!-- /.form-field -->
                </div>

                <div class="btn-controls">
                  <button class="btn-primary">Enregister</button>
                  <button type="reset" role="button" data-toggle="collapse" data-target="#profile-security-question-view" data-parent="#profile-security-question-section" class="btn-default" aria-controls="#profile-security-question-view" aria-expanded="true">Annuler l'édition</button>
                </div><!-- /.btn-controls -->
              </form><!-- /.form-security-question-edit -->
            </section><!-- /#profile-security-question-edit -->
          </section><!-- /.ui-toggle-group -->
        </article><!-- /.panel -->

        {# SECURITY QUESTION #}
        <article id="panel-connexion" class="panel">
          <header class="panel-header">
            <h3>Historique de connexion</h3>
          </header><!-- .panel-header -->
          <p>Ce tableau vous renseigne sur les différents navigateurs où à été ouvert votre compte Unilend. Si vous activez les alertes de connexion, vous serez prévenu en cas d'accès à votre compte depuis un navigateur inconnu. Cela nous permet de mieux protéger votre compte.</p>
          <div class="row">
            {# @todo AJAX script to switch on/off alerts from this input. See main.dev.js #}
            {{ customInput.switch({
              id: 'form-security-connexion-alerts',
              isChecked: userProfile.alerts.connexion
            }) }}
            <label for="form-security-connexion-alerts" class="field-label-inline">Activer les alertes de connexion</label>
          </div>
          {% if userProfile.sessions is not empty %}
          <ul class="list-connexion-sessions">
            {% for i, session in userProfile.sessions %}
              {% if session.endDate is not empty %}
                {% set sessionPeriod = session.startDate|time_diff(session.endDate) %}
              {% else %}
                {% set sessionPeriod = session.startDate|time_diff %}
              {% endif %}
            <li class="connexion-session">
              <div class="connexion-session-ua">
                <div class="connexion-session-browser">{{ session.browser }}</div>
                <div class="connexion-session-os">{{ session.os }}</div>
              </div>
              <div class="connexion-session-location">{{ session.location }}</div>
              <div class="connexion-session-period"><span title="Du {{ session.startDate|date('j F Y H:i')|escape('html_attr') }}{% if session.endDate is not empty %} à {{ session.endDate|date('j F Y H:i')|escape('html_attr') }}{% endif %}" data-toggle="tooltip">{{ sessionPeriod }}</span></div>
              <div class="connexion-session-controls">
                {% if session.status == 'active' %}<a href="#todo" class="link">Déconnexion</a>{% else %}Déconnecté{% endif %}
              </div>
            </li><!-- /.connexion -->
            {% endfor %}
          </ul>
          {% endif %}
        </article><!-- /.panel -->

      </div><!-- /#profile-security.dashboard-tab-pane -->

      <div id="profile-alerts" role="tabpanel" class="dashboard-tab-pane tab-pane">
        <form id="form-alerts" class="panel form-alerts">
          <header class="panel-header">
            <h3>Alertes email instantanées</h3>
          </header>
          <div class="panel-content">
            <p>Choisissez les évènements pour lesquels vous souhaitez recevois un email de notification instantané. Pour rappel toutes vos notifications apparaïssent également dans la colonne de gauche de votre espace client.</p>
            <ul class="list-block">
              <li>
                {{ customInput.switch({
                  id: 'alert-projects_new',
                  name: 'alerts[project_new]',
                  isChecked: userProfile.alerts.projects_new
                }) }}
                <label for="alert-projects_new">Annonce des nouveaux projets</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-offers_made',
                  name: 'alerts[offers_made]',
                  isChecked: userProfile.alerts.offers_made
                }) }}
                <label for="alert-offers_made">Offres réalisées</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-offers_accepted',
                  name: 'alerts[offers_accepted]',
                  isChecked: userProfile.alerts.offers_accepted
                }) }}
                <label for="alert-offers_accepted">Offres acceptées</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-offers_rejected',
                  name: 'alerts[offers_rejected]',
                  isChecked: userProfile.alerts.offers_rejected
                }) }}
                <label for="alert-offers_rejected">Offres refusées</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-remboursements',
                  name: 'alerts[remboursements]',
                  isChecked: userProfile.alerts.remboursements
                }) }}
                <label for="alert-remboursements">Remboursements, retards et régularisations</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-confirmation_deposit',
                  name: 'alerts[confirmation_deposit]',
                  isChecked: userProfile.alerts.confirmation_deposit
                }) }}
                <label for="alert-confirmation_deposit">Confirmation d'alimentation de votre compte</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-confirmation_withdraw',
                  name: 'alerts[confirmation_withdraw]',
                  isChecked: userProfile.alerts.confirmation_withdraw
                }) }}
                <label for="alert-confirmation_withdraw">Confirmation de retrait</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-autolend_balance_low',
                  name: 'alerts[autolend_balance_low]',
                  isChecked: userProfile.alerts.autolend_balance_low
                }) }}
                <label for="alert-autolend_balance_low">Autolend: solde faible</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-autolend_balance_negative',
                  name: 'alerts[autolend_balance_negative]',
                  isChecked: userProfile.alerts.autolend_balance_negative
                }) }}
                <label for="alert-autolend_balance_negative">Autolend: insuffisant</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-connexion',
                  name: 'alerts[connexion]',
                  isChecked: userProfile.alerts.connexion
                }) }}
                <label for="alert-connexion">Alertes de connexion</label>
              </li>
            </ul>
          </div>
          <header class="panel-header">
            <h3>Vos synthèses email</h3>
          </header>
          <div class="panel-content">
            <p>Unilend prépare pour vous une synthèse résumant les derniers évènements de votre compte prêteur. Choisissez la fréquence de réception de ces synthèses.</p>
            <ul class="list-block">
              <li>
                {{ customInput.switch({
                  id: 'alert-frequency-daily',
                  name: 'alerts[frequency][daily]',
                  isChecked: userProfile.alerts.frequency.daily
                }) }}
                <label for="alert-frequency-daily">Une fois par jour</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-frequency-weekly',
                  name: 'alerts[frequency][weekly]',
                  isChecked: userProfile.alerts.frequency.weekly
                }) }}
                <label for="alert-frequency-weekly">Une fois par semaine</label>
              </li>
              <li>
                {{ customInput.switch({
                  id: 'alert-frequency-monthly',
                  name: 'alerts[frequency][monthly]',
                  isChecked: userProfile.alerts.frequency.monthly
                }) }}
                <label for="alert-frequency-monthly">Une fois par mois</label>
              </li>
            </ul><!-- /.list-block -->
          </div><!-- /.panel-content -->
        </form><!-- /#form-alerts.panel -->
      </div><!-- /#profile-alerts.dashboard-tab-pane -->

    </div><!-- /.dashboard-tabs-content -->
  </div><!-- /.dashboard-tabs -->

{% endblock %}
