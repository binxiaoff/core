{# Basic Page Layout #}
{% set bodyClassNames = '' %}

<!DOCTYPE html>
<!--[if lt IE 9]><html lang="{{ app.request.locale }}" class="lt-ie9 no-js"><![endif]-->
<!--[if IE 9]><html lang="{{ app.request.locale }}" class="ie9 no-js"><![endif]-->
<!--[if gt IE 9]><!--><html lang="{{ app.request.locale }}" class="no-js"><!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% if page.isIndexable is defined and not page.isIndexable %}
        <meta name="robots" content="noindex">
    {% endif %}
    <title>{% if page.title is defined %}{{ page.title }} — {% endif %}{{ site.title|default('Unilend') }}</title>
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Cabin:400,700,400" media="all">
    <!-- @todo Canonical -->
    <!-- @todo OpenGraph and Twitter meta tags will go here -->

    {% block extendMeta %}
    <!-- @todo pages can overwrite this block to inject meta tags per page -->
    {% endblock %}

    {% block cssDependencies %}
        {# Mapbox #}
        <link href="https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.css" rel="stylesheet" />
        <link href="https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css" rel="stylesheet" />
        <link href="https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css" rel="stylesheet" />
    {% endblock %}

    <!-- CSS Site -->
    {% block cssFiles %}
        <link rel="stylesheet" href="{{ asset('js/vendor/videojs/video-js.min.css', 'gulp') }}" />
        <link rel="stylesheet" href="{{ asset('js/vendor/swiper/css/swiper.min.css', 'gulp') }}" />
        <link rel="stylesheet" href="{{ asset('js/vendor/fancybox/css/jquery.fancybox.css', 'gulp') }}" />
        <link rel="stylesheet" href="{{ asset('js/vendor/jquery-ui/themes/base/minified/jquery-ui.min.css', 'gulp') }}" />
        <link rel="stylesheet" href="{{ asset('fonts/style.css', 'gulp') }}" />
        <link rel="stylesheet" href="{{ asset('css/main.css', 'gulp') }}" />
    {% endblock %}

    <link rel="apple-touch-icon" sizes="180x180" href="{{ asset('favicons/apple-touch-icon.png', 'gulp') }}">
    <link rel="icon" type="image/png" href="{{ asset('favicons/favicon-32x32.png', 'gulp') }}" sizes="32x32">
    <link rel="icon" type="image/png" href="{{ asset('favicons/favicon-16x16.png', 'gulp') }}" sizes="16x16">
    <link rel="manifest" href="{{ asset('favicons/manifest.json', 'gulp') }}">
    <link rel="mask-icon" href="{{ asset('favicons/safari-pinned-tab.svg', 'gulp') }}" color="#5bbad5">
    <link rel="shortcut icon" href="{{ asset('favicons/favicon.ico', 'gulp') }}">
    <meta name="msapplication-config" content="{{ asset('favicons/browserconfig.xml', 'gulp') }}">
    <meta name="theme-color" content="#ffffff">

    <!-- JS -->
    <script type="text/javascript">
      {#var site = JSON.parse('{{ site|json_encode|escape('js') }}')#}
    </script>

    {% block extendHead %}
    {% endblock %}
</head>
  <body class="{% if app.user is defined %}ui-user-level-{{ app.user.level|default(1) }}{% endif %}{% if bodyClassNames is defined %} {{ bodyClassNames }}{% endif %}">
  {{ google_tag_manager() }}
<div id="top" class="site">
    {% block siteHeader %}
        {% if app.user is defined and is_granted('ROLE_LENDER') %}
            {% include 'partials/site/connected_header_lender.html.twig' %}
        {% elseif app.user is defined and is_granted('ROLE_BORROWER') %}
            {% include 'borrower_account/connected_header_borrower.html.twig' %}
        {% else %}
            {% include 'partials/site/header.html.twig' %}
        {%  endif %}
    {% endblock %}

    <div class="site-content">
        {% block siteContent %}
            {% include 'partials/site/not-found.twig' %}
        {% endblock %}
    </div>

    {% if not app.request.cookies.has('acceptCookies') %}
        {% block siteCookie %}
            {% include 'partials/site/cookie-box.html.twig' %}
        {% endblock %}
    {% endif %}

    {% block siteFooter %}
        {{ render_esi(controller('UnilendFrontBundle:Main:footer')) }}
    {% endblock %}
</div>

{% block debug %}
    {% if app.environment == 'dev' %}
        <div class="debug" aria-hidden="true">
            <div>
        <span class="show-mobile-inline">
          <code>mobile</code>
          <span class="show-mobile-p-inline"><code>mobile-p</code></span>
          <span class="show-mobile-l-inline"><code>mobile-l</code></span>
        </span>
        <span class="show-tablet-inline">
          <code>tablet</code>
          <span class="show-tablet-p-inline"><code>tablet-p</code></span>
          <span class="show-tablet-l-inline"><code>tablet-l</code></span>
        </span>
        <span class="show-computer-inline">
          <code>computer</code>
          <span class="show-laptop-inline"><code>laptop</code></span>
          <span class="show-desktop-inline"><code>desktop</code></span>
        </span>
                <span class="show-lg-inline"><code>lg</code></span>
                <span class="show-md-inline"><code>md</code></span>
                <span class="show-sm-inline"><code>sm</code></span>
                <span class="show-xs-inline"><code>xs</code></span>
            </div>
            <div class="breakpoint-visualiser">
                <div style="position: relative; border-top: solid 1px #000;">
                    <div class="width-desktop"></div>
                    <div class="bpv-wrap">
                        <div class="width-laptop"></div>
                    </div>
                    <div class="bpv-wrap">
                        <div class="width-tablet-l"></div>
                    </div>
                    <div class="bpv-wrap">
                        <div class="width-tablet-p"></div>
                    </div>
                    <div class="bpv-wrap">
                        <div class="width-mobile-l"></div>
                    </div>
                    <div class="bpv-wrap">
                        <div class="width-mobile-p"></div>
                    </div>
                    <div class="bpv-wrap">
                        <div class="hero-wrap" title=".hero-wrap"></div>
                    </div>
                </div>
                <div style="position: relative; border-top: solid 1px #000;">
                    <div class="width-lg"></div>
                    <div class="bpv-wrap">
                        <div class="width-md"></div>
                    </div>
                    <div class="bpv-wrap">
                        <div class="width-sm"></div>
                    </div>
                    <div class="bpv-wrap">
                        <div class="width-xs"></div>
                    </div>
                    <div class="bpv-wrap">
                        <div class="site-wrap" title=".site-wrap"></div>
                    </div>
                </div>
            </div><!-- /.breakpoint-visualiser -->
        </div><!-- /.debug -->
    {% endif %}
{% endblock %}

<div class="modal-spinner">
    <div id="floatingCirclesG">
        <div class="f_circleG" id="frotateG_01"></div>
        <div class="f_circleG" id="frotateG_02"></div>
        <div class="f_circleG" id="frotateG_03"></div>
        <div class="f_circleG" id="frotateG_04"></div>
        <div class="f_circleG" id="frotateG_05"></div>
        <div class="f_circleG" id="frotateG_06"></div>
        <div class="f_circleG" id="frotateG_07"></div>
        <div class="f_circleG" id="frotateG_08"></div>
    </div>
</div>

<div rel="templates" style="display:none">
    {% block modals %}
        {# Place page-specific modals in this block and then use the `data-modal-toggle="#modal-id"` attribute on the anchor/button element you want to use to show it,
           e.g. <a href="javascript:;" data-modal-toggle="#modal-tos">Open the TOS model</a> #}
    {% endblock %}

    {# Global site-wide modals can be placed here #}
    {% set tos_session_key = constant('Unilend\\Bundle\\CoreBusinessBundle\\Service\\ClientManager::SESSION_KEY_TOS_ACCEPTED') %}
    {% if app.user
        and app.session.has(tos_session_key)
        and false == app.session.get(tos_session_key) %}
        <div id="modal-tos" data-modal data-modal-openonload="true"><form id="form-tos" method="post" action="{{ path('tos_popup') }}"></form></div>
    {% endif %}
</div>

{# Placeholder data for notifications #}
{# partials/components/dashboard-panel-notifications.twig will need to reference this object as well #}
{% set placeholderNotifications = [{
    id: 8,
    type: 'project-added',
    title: 'Nouveau projet',
    datetime: 'now'|date_modify('-1 minute')|date('j F, H:i'),
    content: 'Created a new project.',
    image: svgimage('#notification-project-added', 'Nouveau projet', 100, 100, 'none'),
    status: 'unread'
},{
    id: 7,
    type: 'offer-rejected',
    title: 'Offre refusée',
    datetime: 'now'|date_modify('-5 minutes')|date('j F, H:i'),
    content: 'Votre offre de prêt de 45€ au taux de 9,4% à Garage Toniol a été refusée.',
    image: svgimage('#notification-offer-rejected', 'Offre refusée', 100, 100, 'none'),
    status: 'unread'
},{
    id: 6,
    type: 'remboursement',
    title: 'Remboursement',
    datetime: 'now'|date_modify('-2 hours')|date('j F, H:i'),
    content: 'Vous avez reçu un remboursement de 12,35€ de Garage Toniol.',
    image: svgimage('#notification-remboursement', 'Remboursement', 100, 100, 'none'),
    status: 'unread'
},{
    id: 5,
    type: 'offer-accepted',
    title: 'Remboursement',
    datetime: 'now'|date_modify('-3 days')|date('j F, H:i'),
    content: 'Vous avez reçu un remboursement de 12,35€ de Garage Toniol.',
    image: svgimage('#notification-offer-accepted', 'Offre acceptée', 100, 100, 'none'),
    status: 'unread'
},{
    id: 4,
    type: 'account',
    title: 'Solde bas',
    datetime: 'now'|date_modify('-4 days')|date('j F, H:i'),
    content: '',
    image: svgimage('#notification-account-lowbalance', 'Solde bas', 100, 100, 'none'),
    status: 'read'
},{
    id: 3,
    type: 'remboursement',
    title: 'Remboursement',
    datetime: 'now'|date_modify('-5 days 8 hours 35 minutes')|date('j F, H:i'),
    content: 'Vous avez reçu un remboursement de 12,35€ de Garage Toniol.',
    image: svgimage('#notification-remboursement', 'Remboursement', 100, 100, 'none'),
    status: 'read'
},{
    id: 2,
    type: 'remboursement',
    title: 'Remboursement',
    datetime: 'now'|date_modify('-5 days 15 hours 20 minutes')|date('j F, H:i'),
    content: 'Vous avez reçu un remboursement de 12,35€ de Garage Toniol.',
    image: svgimage('#notification-remboursement', 'Remboursement', 100, 100, 'none'),
    status: 'read'
},{
    id: 1,
    type: 'project-added',
    title: 'Nouveau projet',
    datetime: 'now'|date_modify('-6.5 days')|date('j F, H:i'),
    content: 'Created a new project.',
    image: svgimage('#notification-project-added', 'Nouveau projet', 100, 100, 'none'),
    status: 'read'
}] %}
<script type="text/javascript">
    // User notifications
    {# Put in the notifications as a JSON object here, then other JS components can reference as a single source rather than dotted throughout multiple files #}
    var USERNOTIFICATIONS = JSON.parse('{{ placeholderNotifications|json_encode|escape('js')|raw }}');

    // Translations for JS modules
    var UTILITY_LANG = JSON.parse('{{ dictionary('utility')|json_encode|escape('js')|raw }}');
    var AUTOCOMPLETE_LANG = JSON.parse('{{ dictionary('auto-complete')|json_encode|escape('js')|raw }}');
    var FORMVALIDATION_LANG = JSON.parse('{{ dictionary('form-validation')|json_encode|escape('js')|raw }}');
    var PASSWORDCHECK_LANG = JSON.parse('{{ dictionary('password-check')|json_encode|escape('js')|raw }}');
    var SORTABLE_LANG = JSON.parse('{{ dictionary('sortable')|json_encode|escape('js')|raw }}');
    var FILEATTACH_LANG = JSON.parse('{{ dictionary('file-attach')|json_encode|escape('js')|raw }}');
    var USERNOTIFICATIONS_LANG = JSON.parse('{{ dictionary('user-notifications')|json_encode|escape('js')|raw }}');
    var MAPVIEW_LANG = JSON.parse('{{ dictionary('mapview')|json_encode|escape('js')|raw }}')
</script>

<script type="text/javascript" src="https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.js"></script>
<script type="text/javascript" src="https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js"></script>
<script type="text/javascript" src="{{ asset('js/dependencies.js', 'gulp') }}"></script>
<script type="text/javascript" src="{{ asset('js/main.js', 'gulp') }}"></script>

{% block extendFoot %}
{% endblock %}
</body>
</html>
