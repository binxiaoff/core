{% extends 'layouts/_layout.html.twig' %}

{% block siteContent %}
    <article id="deposer-projet" class="page">
        <div class="hero-wrap">
            <header class="page-header">
                <div class="site-wrap">
                    <h1 id="project-create-title" class="h1">{% trans %} project-request_page-title {% endtrans %}</h1>
                </div><!-- /.site-wrap -->
            </header><!-- /.page-header -->

            <div class="page-content">
                <div class="site-wrap">
                    <form id="form-project-create" action="{{ path('project_request_contact_form', {'hash' : project.hash}) }}" method="post" class="form-project-create">
                        <div class="row">
                            <div class="col-lg-8 col-md-8">
                                <div class="form-project-create-nav tab-nav">
                                    <ul class="nav nav-progress">
                                        <li id="project-create-1" role="presentation" class="active">
                                            <span>
                                                <span class="project-create-progress-point">1.</span>
                                                <span class="label hide-mobile">{% trans %} project-request_contact-tab-title {% endtrans %}</span>
                                            </span>
                                        </li>
                                        <li id="project-create-2" role="presentation">
                                            <span>
                                                <span class="project-create-progress-point">2.</span>
                                                <span class="label hide-mobile">{% trans %} project-request_finance-tab-title {% endtrans %}</span>
                                            </span>
                                        </li>
                                        <li id="project-create-3" role="presentation">
                                            <span>
                                                <span class="project-create-progress-point">3.</span>
                                                <span class="label hide-mobile">{% trans %} project-request_end-tab-title {% endtrans %}</span>
                                            </span>
                                        </li>
                                    </ul><!-- /.nav-progress -->
                                </div><!-- /.form-project-create-nav -->
                            </div>
                        </div>

                        <div class="row ui-sticky-parent">
                            <div class="col-form col-lg-8 col-md-8">
                                <div class="form-project-create-content tab-content">
                                    <div id="form-project-create-1" aria-labelledby="project-create-1 project-create-title" data-formvalidation
                                         data-formvalidation-notificationselem="#form-project-create-1-notifications">
                                        <fieldset class="panel">
                                            <div id="form-project-create-1-notifications" class="ui-formvalidation-notifications">
                                                {% if form.errors is not empty %}
                                                    <div class="message-error"><p>{% trans %} form-validation_error-group-has-errors {% endtrans %}</p></div>
                                                {% endif %}
                                            </div>

                                            <h3 class="h3">{% trans %} project-request_step-1-title {% endtrans %}</h3>

                                            <div class="row row-multi-col-computer">
                                                <div class="form-field col-lg-6 col-md-6">
                                                    <div class="field-label">
                                                        {% trans %} project-request_step-1-amount-field-label {% endtrans %}
                                                    </div>
                                                    <div class="input-group set-left">
                                                        <strong>{{ project.amount|localizednumber }}&nbsp;€</strong>
                                                    </div><!-- /.input-group -->
                                                </div><!-- /.form-field -->

                                                <div class="form-field col-lg-6 col-md-6{% if form.errors.project.duration is defined %} ui-formvalidation-error{% endif %}">
                                                    <div class="field-label">
                                                        <label for="form-project-create-duration">
                                                            {% trans %} project-request_step-1-period-field-label {% endtrans %}
                                                            <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span>
                                                        </label>
                                                    </div>
                                                    <select id="form-project-create-duration" name="duration" class="input-field" data-formvalidation-input
                                                            data-formvalidation-required="true">
                                                        <option value="">{% trans %} project-request_step-1-period-select {% endtrans %}</option>
                                                        {% for period in loan_periods %}
                                                            <option value="{{ period }}"{% if period == form.values.project.duration %} selected{% endif %}>{% trans with {'%period%' : period} %} project-request_step-1-period-select-months {% endtrans %}</option>
                                                        {% endfor %}
                                                    </select>
                                                    {% if form.errors.project.duration is defined %}
                                                        <ul class="ui-formvalidation-messages">
                                                            <li>{% trans %} form-validation_error-field-required-select {% endtrans %}</li>
                                                        </ul>
                                                    {% endif %}
                                                </div><!-- /.form-field -->
                                            </div>
                                        </fieldset>
                                        <fieldset class="panel">
                                            <h3 class="h3">
                                                {% if project.getIdBorrowingMotive() == constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\BorrowingMotive::ID_MOTIVE_FRANCHISER_CREATION') %}
                                                    {% trans %} project-request_step-1-franchiser-information-title {% endtrans %}
                                                {% else %}
                                                    {% trans %} project-request_step-1-company-information-title {% endtrans %}
                                                {% endif %}
                                            </h3>

                                            <div class="row">
                                                {% if project.idCompany.name is not empty %}
                                                    <div class="form-field col-lg-6 col-md-6">
                                                        <div class="field-label">
                                                            {% trans %} project-request_step-1-company-name-field-label {% endtrans %}
                                                        </div>
                                                        <div class="input-group">
                                                            <strong>{{ project.idCompany.name }}</strong>
                                                        </div><!-- /.input-group -->
                                                    </div><!-- /.form-field -->
                                                {% endif %}
                                                {% if project.idCompany.siren is not empty %}
                                                    <div class="form-field col-lg-6 col-md-6">
                                                        <div class="field-label">
                                                            {% trans %} project-request_step-1-company-siren-field-label {% endtrans %}
                                                        </div>
                                                        <div class="input-group">
                                                            <strong>{{ project.idCompany.siren }}</strong>
                                                        </div><!-- /.input-group -->
                                                    </div><!-- /.form-field -->
                                                {% endif %}
                                                {% if project.idCompany.dateCreation is not empty %}
                                                    <div class="form-field col-lg-6 col-md-6">
                                                        <div class="field-label">
                                                            {% trans %} project-request_step-1-company-creation-date-field-label {% endtrans %}
                                                        </div>
                                                        <div class="input-group">
                                                            <strong>{{ project.idCompany.dateCreation|localizeddate('short', 'none') }}</strong>
                                                        </div><!-- /.input-group -->
                                                    </div><!-- /.form-field -->
                                                {% endif %}
                                                {% if project.idCompany.capital > 0 %}
                                                    <div class="form-field col-lg-6 col-md-6">
                                                        <div class="field-label">
                                                            {% trans %} project-request_step-1-company-capital-field-label {% endtrans %}
                                                        </div>
                                                        <div class="input-group">
                                                            <strong>{{ project.idCompany.capital|localizedcurrency('EUR') }}</strong>
                                                        </div><!-- /.input-group -->
                                                    </div><!-- /.form-field -->
                                                {% endif %}
                                                {% if project.idCompany.idAddress is not null %}
                                                    <div class="form-field col-lg-6 col-md-6">
                                                        <div class="field-label">
                                                            {% trans %} project-request_step-1-company-address-field-label {% endtrans %}
                                                        </div>
                                                        <div class="input-group">
                                                            <strong>{{ project.idCompany.idAddress.address }}<br>{{ project.idCompany.idAddress.zip }} {{ project.idCompany.idAddress.city }}
                                                            </strong>
                                                        </div><!-- /.input-group -->
                                                    </div><!-- /.form-field -->
                                                {% endif %}
                                                {% if lastBalanceSheet is not null %}
                                                    <div class="form-field col-lg-6 col-md-6">
                                                        <div class="field-label">
                                                            {% trans %} project-request_step-1-company-last-balance-sheet-date-field-label {% endtrans %}
                                                        </div>
                                                        <div class="input-group">
                                                            <strong>{{ lastBalanceSheet.clotureExerciceFiscal|localizeddate('short', 'none') }}</strong>
                                                        </div><!-- /.input-group -->
                                                    </div><!-- /.form-field -->
                                                {% endif %}
                                            </div>
                                        </fieldset>
                                        <fieldset class="panel">
                                            <h3 class="h3">{% trans %} project-request_step-1-representative-identity-section-title {% endtrans %}</h3>
                                            {% if activeExecutives is not empty %}
                                                <div class="row row-multi-col-computer">
                                                    <div class="form-field field-label col-lg-3 col-md-3">
                                                        <label>
                                                            {% trans %} project-request_step-1-representative-identity-who {% endtrans %}
                                                        </label>
                                                    </div><!-- /.form-field -->
                                                    <div class="form-field col-lg-9 col-md-9">
                                                        <select id="identity-executive-selector" name="executive" class="input-field">
                                                            {% for executive in activeExecutives %}
                                                                {% set position = executive.position %}
                                                                {% if executive.companyName is not null %}
                                                                    {% set position = 'project-request_step-1-position-of-company'|trans({'%position%': executive.position, '%company%': executive.companyName}) %}
                                                                {% endif %}
                                                                <option value="{{ executive.idExecutive|escape('html_attr') }}"
                                                                        {% if (executive.lastName|trim ~ executive.firstName|trim)|lower == (form.values.contact.lastName ~ form.values.contact.firstName)|lower %} selected{% endif %}
                                                                        data-executive-title="{{ executive.title|trim|escape('html_attr') }}"
                                                                        data-executive-last-name="{{ executive.lastName|trim|escape('html_attr') }}"
                                                                        data-executive-first-name="{{ executive.firstName|trim|escape('html_attr') }}"
                                                                        data-executive-function="{{ position|trim|escape('html_attr') }}">
                                                                    {{ executive.title }}{% if 'M' == executive.title %}.{% endif %} {{ executive.lastName|trim }} {{ executive.firstName|trim }}
                                                                </option>
                                                            {% endfor %}
                                                            <option value=""
                                                                    {% if contactInList == false and (form.values.otherContact.lastName ~ form.values.otherContact.firstName)|lower == (form.values.contact.lastName ~ form.values.contact.firstName)|lower %} selected{% endif %}
                                                                    data-executive-title="{{ form.values.otherContact.title|escape('html_attr') }}"
                                                                    data-executive-last-name="{{ form.values.otherContact.lastName|escape('html_attr') }}"
                                                                    data-executive-first-name="{{ form.values.otherContact.firstName|escape('html_attr') }}"
                                                                    data-executive-function="{{ form.values.otherContact.function|escape('html_attr') }}">
                                                                {% trans %} project-request_step-1-representative-identity-other-people {% endtrans %}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                            {% endif %}
                                            <div class="row">
                                                <div class="form-field form-field-multi{% if form.errors.contact.title is defined %} ui-formvalidation-error{% endif %}">
                                                    <div class="field-label">
                                                        <label>
                                                            {% trans %} common_title {% endtrans %}
                                                            <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span>
                                                        </label>
                                                    </div>
                                                    <ul class="list-input-values" data-formvalidation-input data-formvalidation-required="true">
                                                        <li>
                                                            <label>
                                                                <input type="radio" name="title" value="Mme"{% if 'Mme' == form.values.contact.title %} checked{% endif %}/>
                                                                {% trans %} common_title-female {% endtrans %}
                                                            </label>
                                                        </li>
                                                        <li>
                                                            <label>
                                                                <input type="radio" name="title" value="M."{% if 'M.' == form.values.contact.title or 'M' == form.values.contact.title %} checked{% endif %}/>
                                                                {% trans %} common_title-male {% endtrans %}
                                                            </label>
                                                        </li>
                                                    </ul>
                                                    {% if form.errors.contact.title is defined %}
                                                        <ul class="ui-formvalidation-messages">
                                                            <li>{% trans %} form-validation_error-field-required-radio {% endtrans %}</li>
                                                        </ul>
                                                    {% endif %}
                                                </div><!-- /.form-field -->
                                            </div>

                                            <div class="row row-multi-col-computer">
                                                <div class="form-field col-lg-6 col-md-6{% if form.errors.contact.lastName is defined %} ui-formvalidation-error{% endif %}">
                                                    <label for="form-project-create-identity-nom">
                                                        {% trans %} common_name {% endtrans %}
                                                        <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span>
                                                    </label>
                                                    <input id="form-project-create-identity-nom" type="text" name="lastName" value="{{ form.values.contact.lastName|escape('html_attr') }}" class="input-field"
                                                           data-formvalidation-input data-formvalidation-required="true" data-formvalidation-type="name"/>
                                                    {% if form.errors.contact.lastName is defined %}
                                                        <ul class="ui-formvalidation-messages">
                                                            <li>{% trans %} form-validation_error-field-required {% endtrans %}</li>
                                                        </ul>
                                                    {% endif %}
                                                </div><!-- /.form-field -->

                                                <div class="form-field col-lg-6 col-md-6{% if form.errors.contact.firstName is defined %} ui-formvalidation-error{% endif %}">
                                                    <label for="form-project-create-identity-prenom">
                                                        {% trans %} common_firstname {% endtrans %}
                                                        <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span>
                                                    </label>
                                                    <input id="form-project-create-identity-prenom" type="text" name="firstName" value="{{ form.values.contact.firstName|escape('html_attr') }}"
                                                           class="input-field" data-formvalidation-input data-formvalidation-required="true" data-formvalidation-type="name"/>
                                                    {% if form.errors.contact.firstName is defined %}
                                                        <ul class="ui-formvalidation-messages">
                                                            <li>{% trans %} form-validation_error-field-required {% endtrans %}</li>
                                                        </ul>
                                                    {% endif %}
                                                </div><!-- /.form-field -->
                                            </div>

                                            <div class="row row-multi-col-computer">
                                                <div class="form-field col-lg-6 col-md-6{% if form.errors.contact.email is defined %} ui-formvalidation-error{% endif %}">
                                                    <label for="form-project-create-identity-email">
                                                        {% trans %} common_email {% endtrans %}
                                                        <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span>
                                                    </label>
                                                    <input id="form-project-create-identity-email" type="email" name="email" value="{{ form.values.contact.email|escape('html_attr') }}" class="input-field"
                                                           data-formvalidation-input data-formvalidation-required="true" data-formvalidation-type="email"/>
                                                    {% if form.errors.contact.email is defined %}
                                                        <ul class="ui-formvalidation-messages">
                                                            <li>{% trans %} form-validation_error-field-required {% endtrans %}</li>
                                                        </ul>
                                                    {% endif %}
                                                </div><!-- /.form-field -->
                                            </div>

                                            <div class="row row-multi-col-computer">
                                                <div class="form-field col-lg-6 col-md-6{% if form.errors.contact.mobile is defined %} ui-formvalidation-error{% endif %}">
                                                    <label for="form-project-create-identity-mobile">
                                                        {% trans %} common_mobile-phone {% endtrans %}
                                                        <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span>
                                                    </label>
                                                    <div class="input-group">
                                                        <input id="form-project-create-identity-mobile" type="text" name="mobile" value="{{ form.values.contact.mobile|escape('html_attr') }}" class="input-field"
                                                               data-formvalidation-input data-formvalidation-required="true" data-formvalidation-type="telephone"/>
                                                        {% if form.errors.contact.mobile is defined %}
                                                            <ul class="ui-formvalidation-messages">
                                                                <li>{% trans %} form-validation_error-field-required {% endtrans %}</li>
                                                            </ul>
                                                        {% endif %}
                                                    </div>
                                                </div><!-- /.form-field -->

                                                <div class="form-field col-lg-6 col-md-6{% if form.errors.contact.function is defined %} ui-formvalidation-error{% endif %}">
                                                    <label for="form-project-create-identity-function">
                                                        {% trans %} common_position {% endtrans %}
                                                        <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span>
                                                    </label>
                                                    <div class="input-group">
                                                        <input id="form-project-create-identity-function" type="text" name="function" value="{{ form.values.contact.function|escape('html_attr') }}"
                                                               class="input-field" data-formvalidation-input data-formvalidation-required="true"/>
                                                        {% if form.errors.contact.function is defined %}
                                                            <ul class="ui-formvalidation-messages">
                                                                <li>{% trans %} form-validation_error-field-required {% endtrans %}</li>
                                                            </ul>
                                                        {% endif %}
                                                    </div>
                                                </div><!-- /.form-field -->
                                            </div>
                                        </fieldset>

                                        <fieldset class="panel">
                                            <h3 class="h3">{% trans %} project-request_step-1-project-details-title {% endtrans %}</h3>

                                            <div class="row">
                                                <div class="form-field col-lg-12 col-md-12">
                                                    <div class="field-label">
                                                        {% trans %} project-request_project-motive-label {% endtrans %}
                                                    </div>
                                                    <div class="input-group">
                                                        <strong>{{ ('borrowing-motive_motive-' ~ project.idBorrowingMotive)|trans }}</strong>
                                                    </div>
                                                </div><!-- /.form-field -->
                                            </div>

                                            <div class="row">
                                                <div class="form-field col-lg-12 col-md-12{% if form.errors.project.description is defined %} ui-formvalidation-error{% endif %}">
                                                    <label for="form-project-create-description">
                                                        {% trans %} project-request_project-description-label {% endtrans %}
                                                        <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span>
                                                    </label>
                                                    <textarea id="form-project-create-description" name="description" class="input-field" rows="5"
                                                              placeholder="{{ 'project-request_project-description-placeholder'|trans|escape('html_attr') }}" data-formvalidation-input
                                                              data-formvalidation-required="true">{{ form.values.project.description }}</textarea>
                                                    {% if form.errors.project.description is defined %}
                                                        <ul class="ui-formvalidation-messages">
                                                            <li>{% trans %} form-validation_error-field-required {% endtrans %}</li>
                                                        </ul>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </fieldset>

                                        <fieldset class="panel collapse in">
                                            <div class="row">
                                                <div class="form-field form-field-single-checkbox{% if form.errors.terms is defined %} ui-formvalidation-error{% endif %}">
                                                    <label>
                                                        <input type="checkbox" name="terms" value="true" data-formvalidation-input data-formvalidation-required="true">
                                                        <span class="label">{% trans with {'%tosStart%' : '<a href="' ~ terms_of_sale_link ~ '" target="_blank">', '%tosEnd%' : '</a>'} %} project-request_step-1-confirm-terms-of-use {% endtrans %}
                                                            <span class="field-required">* <span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span></span>
                                                    </label>
                                                    {% if form.errors.terms is defined %}
                                                        <ul class="ui-formvalidation-messages">
                                                            <li>{% trans %} form-validation_error-field-required-checkbox {% endtrans %}</li>
                                                        </ul>
                                                    {% endif %}
                                                </div><!-- /.form-field -->
                                            </div>
                                        </fieldset>

                                        <div class="row btn-controls tab-footer">
                                            <div class="col-next col-lg-12 col-md-12">
                                                <button type="submit" class="btn-primary" data-spinnerbutton>
                                                    {% trans %} project-request_step-1-validate-button {% endtrans %}
                                                    <span class="icon fa-angle-right"></span>
                                                </button>
                                            </div>
                                        </div><!-- /.btn-controls.tab-footer -->
                                    </div><!-- /.tab-pane -->
                                </div><!-- /.form-project-create-content -->
                            </div><!-- /.col-form -->

                            <div class="col-sim col-lg-4 col-md-4">
                                <div class="hide-xs hide-sm">
                                    <div class="emprunter-sim-mini ui-has-sticky" data-sticky-bufferbottom="156">
                                        <header class="emprunter-sim-mini-header">
                                            <h4 class="emprunter-sim-mini-title">{% trans %} project-request_simulator-panel-title {% endtrans %}</h4>
                                            <p>{% trans %} project-request_simulator-panel-message {% endtrans %}</p>
                                        </header>
                                        <div class="emprunter-sim-mini-content">
                                            <dl class="list-2col">
                                                <dt id="esim-label-amount">{% trans %} project-request_simulator-panel-amount-label {% endtrans %}</dt>
                                                <dd id="esim-output-amount">{{ project.amount|localizednumber }}&nbsp;€</dd>
                                                <dt id="esim-label-duration">{% trans %} project-request_simulator-panel-estimated-funding-time-label {% endtrans %}</dt>
                                                <dd id="esim-output-duration">{% transchoice averageFundingDuration with {'%averageFundingDuration%' : averageFundingDuration} %} project-request_simulator-panel-estimated-funding-time-value {% endtranschoice %}</dd>
                                            </dl>
                                        </div>
                                        <footer class="emprunter-sim-mini-footer">
                                            <p class="instructions">{% trans %} project-request_simulator-panel-message-duirng-step-1 {% endtrans %}</p>
                                        </footer>
                                    </div><!-- /.emprunter-sim -->
                                </div><!-- /.hide-responsive -->
                            </div><!-- /.col-sim -->
                        </div><!-- /.row -->
                    </form><!-- /.form-project-create -->
                </div><!-- /.site-wrap -->
            </div><!-- /.page-content -->

            {% include 'partials/list_socialmedia.html.twig' %}
        </div><!-- /.hero-wrap -->
    </article><!-- /.page -->
{% endblock %}
