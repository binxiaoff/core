{% extends 'lender_account/_layout_lender.html.twig' %}

{% set page = {
id: 'user-preter-profile',
classNames: 'user-preter-profile'
} %}

{% form_theme forms.securityPwd '/frontbundle/forms/fields.html.twig' %}
{% if forms.securityPwd.vars.valid == false %}
    {% set pwdFormCollapse = 'in' %}
    {% set pwdViewCollapse = '' %}
{% else %}
    {% set pwdFormCollapse = '' %}
    {% set pwdViewCollapse = 'in' %}
{% endif %}

{% form_theme forms.securityQuestion '/frontbundle/forms/fields.html.twig' %}
{% if forms.securityQuestion.vars.valid == false %}
    {% set questionFormCollapse = 'in' %}
    {% set questionViewCollapse = '' %}
{% else %}
    {% set questionFormCollapse = '' %}
    {% set questionViewCollapse = 'in' %}
{% endif %}

{% block dashboardContent %}
    <div class="dashboard-tabs tabs">

        {% include 'lender_profile/partials/tab_navigation.html.twig' %}

        <div class="dashboard-tabs-content tab-content">
            <div id="profile-info" role="tabpanel" class="dashboard-tab-pane tab-pane active">
                <article id="panel-activity" class="panel">
                    <header class="panel-header">
                        <h3>{% trans %} lender-profile_security-activity-section-title {% endtrans %}</h3>
                    </header>
                    <section id="profile-security-activity-section" role="tablist" class="ui-toggle-group" >
                        <section id="profile-security-activity-view" role="tabpanel" class="profile-security-activity-view collapse in">

                            <button data-target="#profile-security-activity-edit" role="button" data-toggle="collapse" data-parent="#profile-security-activity-section" class="btn-edit">
                                <span class="icon fa-pencil-u32"></span>
                                <span class="label">{% trans %} lender-profile_security-activity-section-see-activity-button {% endtrans %}</span>
                            </button>

                            <div class="profile-security-activity-explanation">
                                <span>{% trans %} lender-profile_security-activity-and-devices-message {% endtrans %}</span>
                            </div>

                        </section><!-- /#profile-security-activity-view -->

                        {% include 'lender_profile/partials/activity_devices_list.html.twig' %}
                    </section>
                </article>

                {# PASSWORD #}
                <article id="panel-password" class="panel">
                    <header class="panel-header">
                        <h3>{% trans %} lender-profile_security-password-section-title {% endtrans %}</h3>
                        <div id="form-profile-security-password-notifications">
                            {{ form_errors(forms.securityPwd) }}
                            {% if app.session.flashBag.has('securityPasswordSuccess') %}
                                <div class="message-success">
                                    {% for message in app.session.flashBag.get('securityPasswordSuccess') %}
                                        <span>{{ message }}</span>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </header><!-- .panel-header -->

                    <section id="profile-security-password-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
                        <section id="profile-security-password-view" role="tabpanel" class="profile-security-password-view collapse {{ pwdViewCollapse }}">

                            <button data-target="#profile-security-password-edit" role="button" data-toggle="collapse" data-parent="#profile-security-password-section" class="btn-edit">
                                <span class="icon fa-pencil-u32"></span>
                                <span class="label">{% trans %} lender-profile_security-password-section-modify-button {% endtrans %}</span>
                            </button>

                            <div class="profile-security-password-explanation">
                                <span>{% trans %} lender-profile_security-password-usage-recommandation-message {% endtrans %}</span>
                            </div>

                        </section><!-- /#profile-security-password-view -->

                        <section id="profile-security-password-edit" role="tabpanel" class="profile-security-password-view collapse {{ pwdFormCollapse }}">
                            {{ form_start(forms.securityPwd, {
                                'id' : 'form-profile-security-password-edit',
                                'attr' : {
                                    'class' : 'form-security form-profile-security-password-edit',
                                    'data-formvalidation data-formvalidation-notificationselem' : '#form-profile-security-password-notifications'
                                }
                            }) }}

                            <div class="field-help">
                                <p>{% trans %} lender-profile_security-password-usage-recommandation-message {% endtrans %}</p>
                            </div>

                             <div class="row row-multi-col-computer">
                                    <div class="form-field col-lg-6 col-md-6 {% if forms.securityPwd.formerPassword.vars.errors|length > 0 %}ui-formvalidation-error{% endif %}">
                                        <label for="form-profile-security-password-passe">{% trans %} lender-profile_security-password-section-former-password-field-label {% endtrans %}
                                            <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span></label>
                                        <div class="input-group">
                                            {{ form_widget(forms.securityPwd.formerPassword, {
                                                'id' : 'form-profile-security-password-passe',
                                                'attr' : {
                                                    'class' : 'input-field',
                                                    'data-formvalidation-input data-formvalidation-required' : 'true'
                                                }
                                            }) }}
                                            {{ form_errors(forms.securityPwd.formerPassword) }}

                                        </div><!-- /.input-group -->
                                        <ul class="ui-formvalidation-messages"></ul>
                                    </div><!-- /.form-field -->
                                </div>

                                <div class="row row-multi-col-computer">
                                    <div class="form-field col-lg-6 col-md-6 {% if forms.securityPwd.password.vars.errors|length > 0 %}ui-formvalidation-error{% endif %}">
                                        <label for="form-profile-security-password-passe-new">{% trans %} lender-profile_security-password-section-new-password-field-label {% endtrans %}
                                            <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span></label>
                                        {{ form_widget(forms.securityPwd.password.first, {
                                            'id' : 'form-profile-security-password-passe-new',
                                            'attr' :  {
                                                'class' : 'input-field',
                                                'data-passwordcheck data-formvalidation-input data-formvalidation-required' : 'true',
                                                'data-formvalidation-type' : 'password'
                                            }
                                        }) }}
                                    </div><!-- /.form-field -->
                                    <div class="form-field col-lg-6 col-md-6 {% if forms.securityPwd.password.vars.errors|length > 0 %}ui-formvalidation-error{% endif %}">
                                        <label for="form-profile-security-password-passe-new-conf">{% trans %} lender-profile_security-password-section-new-password-confirmation-field-label {% endtrans %}
                                            <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span></label>
                                        <div class="input-group">
                                            {{ form_widget(forms.securityPwd.password.second, {
                                                'id' : 'form-profile-security-password-passe-new-conf',
                                                'attr' :  {
                                                    'class' : 'input-field',
                                                    'data-formvalidation-input data-formvalidation-required' : 'true',
                                                    'data-formvalidation-samevalueas' : '#form-profile-security-password-passe-new'
                                                }
                                            }) }}
                                        </div>
                                    </div><!-- /.form-field -->
                                    {{ form_errors(forms.securityPwd.password) }}
                                </div>

                                <div class="btn-controls">
                                    <button class="btn-primary" data-spinnerbutton>{% trans %} lender-profile_security-password-section-submit-form-button {% endtrans %}</button>
                                    <button type="reset" role="button" data-toggle="collapse" data-target="#profile-security-password-view" data-parent="#profile-security-password-section" class="btn-default" aria-controls="#profile-security-password-view" aria-expanded="true">{% trans %} lender-profile_security-password-section-cancel-form-button {% endtrans %}</button>
                                </div><!-- /.btn-controls -->
                             {{ form_end(forms.securityPwd) }}
                        </section><!-- /#profile-security-password-edit -->

                    </section><!-- /.ui-toggle-group -->
                </article><!-- /.panel -->

                {# SECURITY QUESTION #}
                <article id="panel-question" class="panel">
                    <header class="panel-header">
                        <h3>{% trans %} lender-profile_security-secret-question-section-title {% endtrans %}</h3>
                        <div id="form-profile-security-question-notifications">
                            {{ form_errors(forms.securityQuestion) }}
                            {% if app.session.flashBag.has('securitySecretQuestionSuccess') %}
                                <div class="message-success">
                                    {% for message in app.session.flashBag.get('securitySecretQuestionSuccess') %}
                                        <span>{{ message }}</span>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </header><!-- .panel-header -->
                    <p>{% trans %} lender-profile_security-secret-question-section-text {% endtrans %}</p>
                    <section id="profile-security-question-section" role="tablist" class="ui-toggle-group" aria-multiselectable="true">
                        <section id="profile-security-question-view" role="tabpanel" class="profile-security-question-view collapse {{ questionViewCollapse }}">

                            <button href="#profile-security-question-edit" role="button" data-toggle="collapse" data-parent="#profile-security-question-section" class="btn-edit">
                                <span class="icon fa-pencil-u32"></span>
                                <span class="label">{% trans %} lender-profile_security-secret-question-section-modify-button {% endtrans %}</span>
                            </button>

                        </section><!-- /#profile-security-question-view -->

                        <section id="profile-security-question-edit" role="tabpanel" class="profile-security-question-view collapse {{ questionFormCollapse }}">
                            {{ form_start(forms.securityQuestion, {
                                'id' : 'form-profile-security-question-edit',
                                'attr' : {
                                    'class' : 'form-security form-profile-security-question-edit',
                                    'data-formvalidation data-formvalidation-notificationselem' : '#form-profile-security-question-notifications'
                                }
                            }) }}
                                <div id="form-profile-security-question-notifications"></div>

                                <div class="row">
                                    <div class="form-field {% if forms.securityQuestion.secreteQuestion.vars.errors|length > 0 %}ui-formvalidation-error{% endif %}">
                                        <label for="form-profile-security-question-q">{% trans %} common_security-question {% endtrans %}
                                            <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span></label>
                                        {{ form_widget(forms.securityQuestion.secreteQuestion, {
                                            'id' : 'form-profile-security-question',
                                            'value' : '',
                                            'attr' : {
                                                'class' : 'input-field',
                                                'data-formvalidation-input data-formvalidation-required' : 'true'
                                            }
                                        }) }}
                                        {{ form_errors(forms.securityQuestion.secreteQuestion) }}
                                    </div><!-- /.form-field -->
                                </div>

                                <div class="row">
                                    <div class="form-field {% if forms.securityQuestion.secreteReponse.vars.errors|length > 0 %}ui-formvalidation-error{% endif %}">
                                        <label for="form-profile-security-question-a">{% trans %} common_security-answer {% endtrans %}
                                            <span class="field-required">*<span class="sr-only"> {% trans %} common_mandatory-field {% endtrans %}</span></span></label>
                                        {{ form_widget(forms.securityQuestion.secreteReponse, {
                                            'id' : 'form-profile-security-question-a',
                                            'value' : '',
                                            'attr' :  {
                                                'class' : 'input-field',
                                                'data-formvalidation-input data-formvalidation-required' : 'true'
                                            }
                                        }) }}
                                        {{ form_errors(forms.securityQuestion.secreteReponse) }}
                                    </div><!-- /.form-field -->
                                </div>

                                <div class="btn-controls">
                                    <button class="btn-primary" data-spinnerbutton>{% trans %} lender-profile_security-secret-question-section-submit-button {% endtrans %}</button>
                                    <button type="reset" role="button" data-toggle="collapse" data-target="#profile-security-question-view" data-parent="#profile-security-question-section" class="btn-default" aria-controls="#profile-security-question-view" aria-expanded="true">{% trans %} lender-profile_security-secret-question-section-cancel-button {% endtrans %}</button>
                                </div><!-- /.btn-controls -->
                            {{ form_end(forms.securityQuestion) }}
                        </section><!-- /#profile-security-question-edit -->

                    </section><!-- /.ui-toggle-group -->
                </article><!-- /.panel -->
            </div><!-- /#profile-info.dashboard-tab-pane -->
        </div><!-- /.dashboard-tabs-content -->
    </div><!-- /.dashboard-tabs -->
{% endblock %}
