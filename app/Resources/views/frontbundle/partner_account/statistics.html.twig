{% extends 'partner_account/_layout.html.twig' %}

{% set page = {
    id: 'partner-account-statistics',
    classNames: 'partner-account'
} %}

{% block dashboardContent %}
    <section class="dashboard-tabs tabs">
        <div class="dashboard-tabs-content tab-content">
            {% include ':frontbundle/partner_account:statistics_graph.html.twig' with {
                'graphTitle': 'Votre performance',
                'graphType': 'user',
                'submittedProjects': graph.user[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REVIEW')].count,
                'acceptedProjects': graph.user[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REVIEW')].count,
                'repaymentProjects': graph.user[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REPAYMENT')].count,
                'submittedAmount': graph.user[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REVIEW')].sum,
                'repaymentAmount': graph.user[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REPAYMENT')].sum,
            } %}
            {% if graph.admin is defined %}
                {% include ':frontbundle/partner_account:statistics_graph.html.twig' with {
                    'graphTitle': 'Vos entit√©s',
                    'graphType': 'admin',
                    'submittedProjects': graph.admin[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REVIEW')].count,
                    'acceptedProjects': graph.admin[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REVIEW')].count,
                    'repaymentProjects': graph.admin[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REPAYMENT')].count,
                    'submittedAmount': graph.admin[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REVIEW')].sum,
                    'repaymentAmount': graph.admin[constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\ProjectsStatus::STATUS_REPAYMENT')].sum,
                } %}
            {% endif %}
        </div><!-- /.dashboard-tabs-content -->
    </section><!-- /.dashboard-tabs -->
{% endblock %}
