{% extends 'partner_account/_layout.html.twig' %}

{% set page = {
    id: 'partner-account-projects-list',
    classNames: 'partner-account'
} %}

{% block dashboardContent %}
    <section class="dashboard-tabs tabs">
        <div class="dashboard-tabs-nav">
            <ul class="nav nav-dashboard-tabs">
                <li role="presentation" class="active">
                    <a href="#tab-prospects" role="tab" data-toggle="tab">{% trans %} partner-project-list_prospects-tab-title {% endtrans %}</a>
                </li>
                <li role="presentation">
                    <a href="#tab-incomplete-projects" role="tab" data-toggle="tab">{% trans %} partner-project-list_incomplete-projects-tab-title {% endtrans %}</a>
                </li>
                <li role="presentation">
                    <a href="#tab-complete-projects" role="tab" data-toggle="tab">{% trans %} partner-project-list_complete-projects-tab-title {% endtrans %}</a>
                </li>
                <li role="presentation">
                    <a href="#tab-abandoned" role="tab" data-toggle="tab">{% trans %} partner-project-list_abandoned-tab-title {% endtrans %}</a>
                </li>
                <li role="presentation">
                    <a href="#tab-rejected" role="tab" data-toggle="tab">{% trans %} partner-project-list_rejected-tab-title {% endtrans %}</a>
                </li>
            </ul>
        </div><!-- /.dashboard-tabs-nav -->

        <div class="dashboard-tabs-content tab-content">
            <article role="tabpanel" class="dashboard-tab-pane tab-pane active" id="tab-prospects">
                <div class="panel">
                    <div class="panel-content">
                        {% if prospects|length > 0 %}
                            <div class="table-scroll">
                                <table class="table table-projects" data-sortable>
                                    <thead class="table-sortable-columns">
                                    <tr>
                                        <th class="table-projects-item-borrower table-sortable-column" data-sortable-by="borrower" colspan="2">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-prospects-borrower'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_prospects-table-borrower {% endtrans %}
                                            </span>
                                        </th>
                                        {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                            <th class="table-projects-item-submitter table-sortable-column" data-sortable-by="submitter">
                                                <span class="label" title="{{ 'partner-project-list_sr-sort-prospects-submitter'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                    {% trans %} partner-project-list_prospects-table-submitter {% endtrans %}
                                                </span>
                                            </th>
                                        {% endif %}
                                        <th class="table-projects-item-amount table-sortable-column" data-sortable-by="amount">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-prospects-amount'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_prospects-table-amount {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-duration table-sortable-column" data-sortable-by="duration">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-prospects-duration'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_prospects-table-duration {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-motif table-sortable-column" data-sortable-by="motif">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-prospects-motif'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_prospects-table-motif {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-date table-sortable-column" data-sortable-by="date">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-prospects-date'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_prospects-table-date {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-actions">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-prospects-action'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_prospects-table-action {% endtrans %}
                                            </span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody data-sortable-content>
                                    {% for project in prospects %}
                                        <tr id="prospect-{{ project.id }}" class="table-projects-item {% if loop.index is divisible by(2) %}even{% else %}odd{% endif %}"
                                            data-hash="{{ project.hash }}"
                                            data-sortable-borrower="{{ project.name|e('html_attr') }}"
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                data-sortable-submitter="{{ project.submitter.lastName|e('html_attr') }} {{ project.submitter.firstName|e('html_attr') }}{% if project.submitter.entity|length %} - {{ project.submitter.entity|e('html_attr') }}{% endif %}"
                                            {% endif %}
                                            data-sortable-motif="{{ project.motive|e('html_attr') }}"
                                            data-sortable-amount="{{ project.amount }}"
                                            data-sortable-duration="{{ project.duration }}"
                                            data-sortable-date="{{ project.date|date('U') }}">
                                            <td class="table-projects-item-borrower" colspan="2">{% if project.name is empty %}<em>{% trans %} partner-project-list_empty-company-name-placeholder {% endtrans %}</em>{% else %}{{ project.name }}{% endif %}</td>
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                <td class="table-projects-item-submitter">{{ project.submitter.lastName }} {{ project.submitter.firstName }}{% if project.submitter.entity|length %}<br>{{ project.submitter.entity }}{% endif %}</td>
                                            {% endif %}
                                            <td class="table-projects-item-amount">{{ project.amount|localizednumber }}&nbsp;€</td>
                                            <td class="table-projects-item-duration">{% trans with {'%duration%': project.duration} %} partner-project-list_prospects-table-duration-value {% endtrans %}</td>
                                            <td class="table-projects-item-motif">{{ project.motive }}</td>
                                            <td class="table-projects-item-date">{{ project.date|date('d/m/Y') }}</td>
                                            <td class="table-actions">
                                                <a role="button" class="btn-default" title="{{ 'partner-project-list_prospects-table-action-cancel'|trans|e('html_attr')}}" data-toggle="tooltip" data-action="abandon"><span class="icon fa-ban-u16"></span></a>
                                                <a role="button" class="btn-default" title="{{ 'partner-project-list_prospects-table-action-submit'|trans|e('html_attr')}}" data-toggle="tooltip" data-action="submit"><span class="icon fa-check-u16"></span></a>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table><!-- /.table-projects -->
                            </div><!-- /.table-scroll -->
                        {% else %}
                            <div class="message-info">{{ 'partner-project-list_prospects-not-found-message'|trans }}</div>
                        {% endif %}
                    </div><!-- /.panel-content -->
                </div><!-- /.panel -->
            </article><!-- /.dashboard-tab-pane -->

            <article role="tabpanel" class="dashboard-tab-pane tab-pane" id="tab-incomplete-projects">
                <div class="panel">
                    <div class="panel-content">
                        {% if incompleteProjects|length > 0 %}
                            <div class="table-scroll">
                                <table class="table table-projects" data-sortable>
                                    <thead class="table-sortable-columns">
                                    <tr>
                                        <th class="table-projects-item-borrower table-sortable-column" data-sortable-by="borrower" colspan="2">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-incomplete-projects-borrower'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_incomplete-projects-table-borrower {% endtrans %}
                                            </span>
                                        </th>
                                        {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                            <th class="table-projects-item-submitter table-sortable-column" data-sortable-by="submitter">
                                                <span class="label" title="{{ 'partner-project-list_sr-sort-incomplete-projects-submitter'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                    {% trans %} partner-project-list_incomplete-projects-table-submitter {% endtrans %}
                                                </span>
                                            </th>
                                        {% endif %}
                                        <th class="table-projects-item-amount table-sortable-column" data-sortable-by="amount">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-incomplete-projects-amount'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_incomplete-projects-table-amount {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-duration table-sortable-column" data-sortable-by="duration">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-incomplete-projects-duration'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_incomplete-projects-table-duration {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-motif table-sortable-column" data-sortable-by="motif">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-incomplete-projects-motif'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_incomplete-projects-table-motif {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-date table-sortable-column" data-sortable-by="date">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-incomplete-projects-date'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_incomplete-projects-table-date {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-actions">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-incomplete-projects-action'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_incomplete-projects-table-action {% endtrans %}
                                            </span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody data-sortable-content>
                                    {% for project in incompleteProjects %}
                                        <tr id="project-{{ project.id }}" class="table-projects-item {% if loop.index is divisible by(2) %}even{% else %}odd{% endif %}{% if project.hasChanged == true %} ui-table-projects-item-changed{% endif %}"
                                            data-hash="{{ project.hash }}"
                                            data-sortable-borrower="{{ project.name|e('html_attr') }}"
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                data-sortable-submitter="{{ project.submitter.lastName|e('html_attr') }} {{ project.submitter.firstName|e('html_attr') }}{% if project.submitter.entity|length %} - {{ project.submitter.entity|e('html_attr') }}{% endif %}"
                                            {% endif %}
                                            data-sortable-motif="{{ project.motive|e('html_attr') }}"
                                            data-sortable-amount="{{ project.amount }}"
                                            data-sortable-duration="{{ project.duration }}"
                                            data-sortable-date="{{ project.date|date('U') }}">
                                            <td class="table-projects-item-borrower" colspan="2">{% if project.name is empty %}<em>{% trans %} partner-project-list_empty-company-name-placeholder {% endtrans %}</em>{% else %}{{ project.name }}{% endif %}</td>
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                <td class="table-projects-item-submitter">{{ project.submitter.lastName }} {{ project.submitter.firstName }}{% if project.submitter.entity|length %}<br>{{ project.submitter.entity }}{% endif %}</td>
                                            {% endif %}
                                            <td class="table-projects-item-amount">{{ project.amount|localizednumber }}&nbsp;€</td>
                                            <td class="table-projects-item-duration">{% trans with {'%duration%': project.duration} %} partner-project-list_incomplete-projects-table-duration-value {% endtrans %}</td>
                                            <td class="table-projects-item-motif">{{ project.motive }}</td>
                                            <td class="table-projects-item-date">{{ project.date|date('d/m/Y') }}</td>
                                            <td class="table-actions">
                                                <a href="{{ path('partner_project_request_details', {hash: project.hash}) }}" class="btn-default" title="{{ 'partner-project-list_incomplete-projects-table-action-submit'|trans|e('html_attr') }}" data-toggle="tooltip"><span class="icon fa-check-u16"></span></a>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table><!-- /.table-projects -->
                            </div><!-- /.table-scroll -->
                        {% else %}
                            <div class="message-info">{{ 'partner-project-list_incomplete-projects-not-found-message'|trans }}</div>
                        {% endif %}
                    </div><!-- /.panel-content -->
                </div><!-- /.panel -->
            </article><!-- /.dashboard-tab-pane -->

            <article role="tabpanel" class="dashboard-tab-pane tab-pane" id="tab-complete-projects">
                <div class="panel">
                    <div class="panel-content">
                        {% if completeProjects|length > 0 %}
                            <div class="table-scroll">
                                <table class="table table-projects" data-sortable>
                                    <thead class="table-sortable-columns">
                                    <tr>
                                        <th class="table-projects-item-borrower table-sortable-column" data-sortable-by="borrower">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-complete-projects-borrower'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_complete-projects-table-borrower {% endtrans %}
                                            </span>
                                        </th>
                                        {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                            <th class="table-projects-item-submitter table-sortable-column" data-sortable-by="submitter">
                                                <span class="label" title="{{ 'partner-project-list_sr-sort-complete-projects-submitter'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                    {% trans %} partner-project-list_complete-projects-table-submitter {% endtrans %}
                                                </span>
                                            </th>
                                        {% endif %}
                                        <th class="table-projects-item-amount table-sortable-column" data-sortable-by="amount">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-complete-projects-amount'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_complete-projects-table-amount {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-duration table-sortable-column" data-sortable-by="duration">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-complete-projects-duration'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_complete-projects-table-duration {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-motif table-sortable-column" data-sortable-by="motif">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-complete-projects-motif'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_complete-projects-table-motif {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-status table-sortable-column" data-sortable-by="status">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-complete-projects-status'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_complete-projects-table-status {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-date table-sortable-column" data-sortable-by="date">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-complete-projects-date'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_complete-projects-table-date {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-actions">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-complete-projects-action'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_complete-projects-table-action {% endtrans %}
                                            </span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody data-sortable-content>
                                    {% for project in completeProjects %}
                                        <tr id="project-{{ project.id }}" class="table-projects-item {% if loop.index is divisible by(2) %}even{% else %}odd{% endif %}{% if project.hasChanged == true %} ui-table-projects-item-changed{% endif %}"
                                            data-hash="{{ project.hash }}"
                                            data-details="{{ project.memos|json_encode|escape('html_attr') }}"
                                            data-details-tos="{{ project.tos|json_encode|escape('html_attr') }}"
                                            data-sortable-borrower="{{ project.name|e('html_attr') }}"
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                data-sortable-submitter="{{ project.submitter.lastName|e('html_attr') }} {{ project.submitter.firstName|e('html_attr') }}{% if project.submitter.entity|length %} - {{ project.submitter.entity|e('html_attr') }}{% endif %}"
                                            {% endif %}
                                            data-sortable-motif="{{ project.motive|e('html_attr') }}"
                                            data-sortable-amount="{{ project.amount }}"
                                            data-sortable-duration="{{ project.duration }}"
                                            data-sortable-date="{{ project.date|date('U') }}"
                                            data-sortable-status="{{ ('partner-project-list_status-' ~ project.status)|trans|e('html_attr') }}">
                                            <td class="table-projects-item-borrower">{% if project.name is empty %}<em>{% trans %} partner-project-list_empty-company-name-placeholder {% endtrans %}</em>{% else %}{{ project.name }}{% endif %}</td>
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                <td class="table-projects-item-submitter">{{ project.submitter.lastName }} {{ project.submitter.firstName }}{% if project.submitter.entity|length %}<br>{{ project.submitter.entity }}{% endif %}</td>
                                            {% endif %}
                                            <td class="table-projects-item-amount">{{ project.amount|localizednumber }}&nbsp;€</td>
                                            <td class="table-projects-item-duration">{% trans with {'%duration%': project.duration} %} partner-project-list_complete-projects-table-duration-value {% endtrans %}</td>
                                            <td class="table-projects-item-motif">{{ project.motive }}</td>
                                            <td class="table-projects-item-status">{{ ('partner-project-list_status-' ~ project.status)|trans }}</td>
                                            <td class="table-projects-item-date">{{ project.date|date('d/m/Y') }}</td>
                                            <td class="table-actions">
                                                {% if project.memos|length > 0 %}
                                                    <a role="button" class="btn-default" title="{{ 'partner-project-list_complete-projects-table-action-see-memos'|trans|e('html_attr') }}" data-toggle="tooltip" data-action="memos"><span class="icon fa-info-u16"></span></a>
                                                {% endif %}
                                                <a role="button" class="btn-default" title="{{ 'partner-project-list_complete-projects-table-action-tos'|trans|e('html_attr') }}" data-toggle="tooltip" data-action="tos"><span class="icon fa-file-u16"></span></a>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table><!-- /.table-projects -->
                            </div><!-- /.table-scroll -->
                        {% else %}
                            <div class="message-info">{{ 'partner-project-list_complete-projects-not-found-message'|trans }}</div>
                        {% endif %}
                    </div><!-- /.panel-content -->
                </div><!-- /.panel -->
            </article><!-- /.dashboard-tab-pane -->

            <article role="tabpanel" class="dashboard-tab-pane tab-pane" id="tab-abandoned">
                <div class="panel">
                    <div class="panel-content">
                        {% if abandoned|length > 0 %}
                            <div class="table-scroll">
                                <table class="table table-projects" data-sortable>
                                    <thead class="table-sortable-columns">
                                    <tr>
                                        <th class="table-projects-item-borrower table-sortable-column" data-sortable-by="borrower">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-abandoned-borrower'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_abandoned-table-borrower {% endtrans %}
                                            </span>
                                        </th>
                                        {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                            <th class="table-projects-item-submitter table-sortable-column" data-sortable-by="submitter">
                                                <span class="label" title="{{ 'partner-project-list_sr-sort-abandoned-submitter'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                    {% trans %} partner-project-list_abandoned-table-submitter {% endtrans %}
                                                </span>
                                            </th>
                                        {% endif %}
                                        <th class="table-projects-item-amount table-sortable-column" data-sortable-by="amount">
                                            <span class="label" title=  "{{ 'partner-project-list_sr-sort-abandoned-amount'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_abandoned-table-amount {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-duration table-sortable-column" data-sortable-by="duration">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-abandoned-duration'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_abandoned-table-duration {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-motif table-sortable-column" data-sortable-by="motif">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-abandoned-motif'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_abandoned-table-motif {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-status">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-abandoned-status'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_abandoned-table-status {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-date table-sortable-column" data-sortable-by="date">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-abandoned-date'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_abandoned-table-date {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-actions">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-abandoned-memos'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_abandoned-table-action-see-memos {% endtrans %}
                                            </span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody data-sortable-content>
                                    {% for project in abandoned %}
                                        <tr id="project-{{ project.id }}" class="table-projects-item {% if loop.index is divisible by(2) %}even{% else %}odd{% endif %}{% if project.hasChanged == true %} ui-table-projects-item-changed{% endif %}"
                                            data-details="{{ project.memos|json_encode|escape('html_attr') }}"
                                            data-sortable-borrower="{{ project.name|e('html_attr') }}"
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                data-sortable-submitter="{{ project.submitter.lastName|e('html_attr') }} {{ project.submitter.firstName|e('html_attr') }}{% if project.submitter.entity|length %} - {{ project.submitter.entity|e('html_attr') }}{% endif %}"
                                            {% endif %}
                                            data-sortable-motif="{{ project.motive|e('html_attr') }}"
                                            data-sortable-amount="{{ project.amount }}"
                                            data-sortable-duration="{{ project.duration }}"
                                            data-sortable-date="{{ project.date|date('U') }}">
                                            <td class="table-projects-item-borrower">{% if project.name is empty %}<em>{% trans %} partner-project-list_empty-company-name-placeholder {% endtrans %}</em>{% else %}{{ project.name }}{% endif %}</td>
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                <td class="table-projects-item-submitter">{{ project.submitter.lastName }} {{ project.submitter.firstName }}{% if project.submitter.entity|length %}<br>{{ project.submitter.entity }}{% endif %}</td>
                                            {% endif %}
                                            <td class="table-projects-item-amount">{{ project.amount|localizednumber }}&nbsp;€</td>
                                            <td class="table-projects-item-duration">{% trans with {'%duration%': project.duration} %} partner-project-list_abandoned-table-duration-value {% endtrans %}</td>
                                            <td class="table-projects-item-motif">{{ project.motive }}</td>
                                            <td class="table-projects-item-status">
                                                {% if project.projectAbandonReasons|length > 0 %}
                                                    {% for abandonReasonHistory in project.projectAbandonReasons %}
                                                        {{ abandonReasonHistory.idAbandonReason.reason|capitalize }}
                                                        {% if loop.index < project.projectAbandonReasons|length %}
                                                            <br>
                                                        {% endif %}
                                                    {% endfor %}
                                                {% else %}
                                                    &nbsp;
                                                {% endif %}
                                            </td>
                                            <td class="table-projects-item-date">{{ project.date|date('d/m/Y') }}</td>
                                            <td class="table-actions">
                                                {% if project.memos|length > 0 %}
                                                    <a role="button" class="btn-default" title="{{ 'partner-project-list_abandoned-table-action-see-memos'|trans|e('html_attr') }}" data-toggle="tooltip" data-action="memos"><span class="icon fa-info-u16"></span></a>
                                                {% else %}
                                                    &nbsp;
                                                {% endif %}
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table><!-- /.table-projects -->
                            </div><!-- /.table-scroll -->
                        {% else %}
                            <div class="message-info">{{ 'partner-project-list_abandoned-not-found-message'|trans }}</div>
                        {% endif %}
                    </div><!-- /.panel-content -->
                </div><!-- /.panel -->
            </article><!-- /.dashboard-tab-pane -->

            <article role="tabpanel" class="dashboard-tab-pane tab-pane" id="tab-rejected">
                <div class="panel">
                    <div class="panel-content">
                        {% if rejected|length > 0 %}
                            <div class="table-scroll">
                                <table class="table table-projects" data-sortable>
                                    <thead class="table-sortable-columns">
                                    <tr>
                                        <th class="table-projects-item-borrower table-sortable-column" data-sortable-by="borrower" colspan="2">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-rejected-borrower'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_rejected-table-borrower {% endtrans %}
                                            </span>
                                        </th>
                                        {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                            <th class="table-projects-item-submitter table-sortable-column" data-sortable-by="submitter">
                                                <span class="label" title="{{ 'partner-project-list_sr-sort-rejected-submitter'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                    {% trans %} partner-project-list_rejected-table-submitter {% endtrans %}
                                                </span>
                                            </th>
                                        {% endif %}
                                        <th class="table-projects-item-amount table-sortable-column" data-sortable-by="amount">
                                            <span class="label" title=  "{{ 'partner-project-list_sr-sort-rejected-amount'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_rejected-table-amount {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-duration table-sortable-column" data-sortable-by="duration">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-rejected-duration'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_rejected-table-duration {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-motif table-sortable-column" data-sortable-by="motif">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-rejected-motif'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_rejected-table-motif {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-projects-item-date table-sortable-column" data-sortable-by="date">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-rejected-date'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_rejected-table-date {% endtrans %}
                                            </span>
                                        </th>
                                        <th class="table-actions">
                                            <span class="label" title="{{ 'partner-project-list_sr-sort-rejected-memos'|trans|e('html_attr') }}" data-toggle="tooltip">
                                                {% trans %} partner-project-list_rejected-table-action-see-memos {% endtrans %}
                                            </span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody data-sortable-content>
                                    {% for project in rejected %}
                                        <tr id="project-{{ project.id }}" class="table-projects-item {% if loop.index is divisible by(2) %}even{% else %}odd{% endif %}{% if project.hasChanged == true %} ui-table-projects-item-changed{% endif %}"
                                            data-details="{{ project.memos|json_encode|escape('html_attr') }}"
                                            data-sortable-borrower="{{ project.name|e('html_attr') }}"
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                data-sortable-submitter="{{ project.submitter.lastName|e('html_attr') }} {{ project.submitter.firstName|e('html_attr') }}{% if project.submitter.entity|length %} - {{ project.submitter.entity|e('html_attr') }}{% endif %}"
                                            {% endif %}
                                            data-sortable-motif="{{ project.motive|e('html_attr') }}"
                                            data-sortable-amount="{{ project.amount }}"
                                            data-sortable-duration="{{ project.duration }}"
                                            data-sortable-date="{{ project.date|date('U') }}">
                                            <td class="table-projects-item-borrower" colspan="2">{% if project.name is empty %}<em>{% trans %} partner-project-list_empty-company-name-placeholder {% endtrans %}</em>{% else %}{{ project.name }}{% endif %}</td>
                                            {% if is_granted(constant('\\Unilend\\Bundle\\CoreBusinessBundle\\Entity\\Clients::ROLE_PARTNER_ADMIN')) %}
                                                <td class="table-projects-item-submitter">{{ project.submitter.lastName }} {{ project.submitter.firstName }}{% if project.submitter.entity|length %}<br>{{ project.submitter.entity }}{% endif %}</td>
                                            {% endif %}
                                            <td class="table-projects-item-amount">{{ project.amount|localizednumber }}&nbsp;€</td>
                                            <td class="table-projects-item-duration">{% trans with {'%duration%': project.duration} %} partner-project-list_rejected-table-duration-value {% endtrans %}</td>
                                            <td class="table-projects-item-motif">{{ project.motive }}</td>
                                            <td class="table-projects-item-date">{{ project.date|date('d/m/Y') }}</td>
                                            <td class="table-actions">
                                                {% if project.memos|length > 0 %}
                                                    <a role="button" class="btn-default" title="{{ 'partner-project-list_rejected-table-action-see-memos'|trans|e('html_attr') }}" data-toggle="tooltip" data-action="memos"><span class="icon fa-info-u16"></span></a>
                                                {% else %}
                                                    &nbsp;
                                                {% endif %}
                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table><!-- /.table-projects -->
                            </div><!-- /.table-scroll -->
                        {% else %}
                            <div class="message-info">{{ 'partner-project-list_rejected-not-found-message'|trans }}</div>
                        {% endif %}
                    </div><!-- /.panel-content -->
                </div><!-- /.panel -->
            </article><!-- /.dashboard-tab-pane -->
        </div><!-- /.dashboard-tabs-content -->
    </section><!-- /.dashboard-tabs -->
{% endblock %}

{% block modals %}
    <div id="modal-partner-project-abandon" data-modal>
        <form action="{{ path('partner_project_request_abandon') }}" method="post" data-formvalidation>
            <input type="hidden" name="hash" value>
            <div class="modal-body text-align-center">
                <p>{% trans with {'%companyName%' : '<span class="ui-modal-output-company"></span>'} %} partner-project-list_popup-prospect-cancel-message {% endtrans %}</p>
                <div class="form-field">
                    <select multiple name="reason[]" id="prospect-abandon-motif" class="input-field select2" data-formvalidation-input data-formvalidation-required="true">
                        {% for abandonReason in abandonReasons %}
                            <option value="{{ abandonReason.idAbandon }}">{{ abandonReason.reason|capitalize }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <footer class="modal-footer">
                <div class="btn-controls">
                    <button type="button" class="btn-default" data-modal-doactioncancel>
                        {% trans %} partner-project-list_popup-prospect-button-cancel {% endtrans %}
                    </button>
                    <button type="submit" class="btn-primary">
                        {% trans %} partner-project-list_popup-prospect-button-submit {% endtrans %}
                    </button>
                </div>
            </footer>
        </form>
    </div><!-- /#modal-partner-project-cancel -->

    <div id="modal-partner-project-submit" data-modal>
        <form action="{{ path('partner_project_request_submit') }}" method="post">
            <input type="hidden" name="hash" value>
            <div class="modal-body text-align-center">
                <p>{% trans with {'%companyName%' : '<span class="ui-modal-output-company"></span>'} %} partner-project-list_popup-prospect-submit-message {% endtrans %}</p>
            </div>
            <footer class="modal-footer">
                <div class="btn-controls">
                    <button type="button" class="btn-default" data-modal-doactioncancel>
                        {% trans %} partner-project-list_popup-prospect-button-cancel {% endtrans %}
                    </button>
                    <button type="submit" class="btn-primary" data-spinnerbutton>
                        {% trans %} partner-project-list_popup-prospect-button-submit {% endtrans %}
                    </button>
                </div>
            </footer>
        </form>
    </div><!-- /#modal-partner-project -->

    <div id="modal-partner-project-tos" data-modal>
        <form action="{{ path('partner_project_tos') }}" method="post">
            <input type="hidden" name="hash" value>
            <div class="modal-body text-align-center">
                <h3>{% trans %} partner-project-list_popup-project-tos-title {% endtrans %}</h3>
                <table class="table">
                    <thead>
                    <tr>
                        <th><span class="c-t3"></span>{% trans %} partner-project-list_popup-project-tos-table-heading {% endtrans %}</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <p class="tos-message">{% trans %} partner-project-list_popup-project-tos-message {% endtrans %}</p>
                <p class="ui-ajax-feedback-message"></p>
            </div>
            <footer class="modal-footer">
                <div class="btn-controls">
                    <button type="button" class="btn-default" data-modal-doactioncancel>
                        {% trans %} partner-project-list_popup-project-tos-button-cancel {% endtrans %}
                    </button>
                    <button type="submit" class="btn-primary" data-spinnerbutton>
                        {% trans %} partner-project-list_popup-project-tos-button-submit {% endtrans %}
                    </button>
                    <button type="button" class="btn-primary ui-ajax-feedback-button" data-modal-doactioncancel>
                        OK
                    </button>
                </div>
            </footer>
        </form>
    </div><!-- /#modal-partner-project-tos -->
{% endblock %}
