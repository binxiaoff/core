{% extends 'layouts/_layout.html.twig' %}

{% block siteContent %}
{% set showPasswordEditionForm = true %}

<article id="connexion-inscription" class="page">
    <section class="page-content">
        <div class="hero-wrap">
            <div class="page-content">
                <div class="push-lg-2 push-md-2 col-lg-8 col-md8">
                    <h1>{% trans %} reset-password.page-title {% endtrans %}</h1>
                    <section class="panel" style="max-width: initial;">
                        <div id="form-security-password-notifications">
                            {% if app.session.flashBag.has('tokenError') %}
                                {% set showPasswordEditionForm = false %}
                                <div class="message-error">
                                    {% for error in app.session.flashBag.get('tokenError') %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            {% if app.session.flashBag.has('passwordErrors') %}
                                <div class="message-error">
                                    {% for error in app.session.flashBag.get('passwordErrors') %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            {% if app.session.flashBag.has('passwordSuccess')%}
                                {% set showPasswordEditionForm = false %}
                                <div class="message-success">
                                    {% for message in app.session.flashBag.get('passwordSuccess') %}
                                        <span>{{ message }}</span>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>

                        {% if showPasswordEditionForm and secretQuestion is defined %}
                            <form id="form-password-forgotten-edit" action="{{ path('password_reset_form', {'securityToken' : token}) }}" method="post" class="form-security form-security-password-edit"
                                  data-formvalidation
                                  data-formvalidation-notificationselem="#form-security-password-notifications">

                                <div class="row row-multi-col-computer">
                                    <div class="form-field col-lg-6 col-md-6">
                                        <label for="reset-password">{% trans %} common_password {% endtrans %}<span class="field-required">*</span></label>
                                        <input id="reset-password" type="password"
                                               name="password" value="" class="input-field"
                                               data-passwordcheck
                                               data-formvalidation-input
                                               data-formvalidation-required="true"
                                               data-formvalidation-type="password">
                                    </div><!-- /.form-field -->
                                    <div class="form-field col-lg-6 col-md-6">
                                        <label for="reset-confirmation">{% trans %} common_password-confirmation {% endtrans %}<span class="field-required">*</span></label>
                                        <input id="reset-confirmation" type="password"
                                               name="confirmation" value="" class="input-field"
                                               data-formvalidation-input
                                               data-formvalidation-required="true"
                                               data-formvalidation-samevalueas="#reset-password">
                                    </div><!-- /.form-field -->
                                </div>

                                <div class="row">
                                    <label>{% trans %} common_security-question {% endtrans %}</label>
                                    <div><em>{{ secretQuestion }}</em></div>
                                </div>

                                <div class="row">
                                    <div class="form-field">
                                        <label for="reset-answer">{% trans %} common_security-answer {% endtrans %}<span class="field-required">*</span></label>
                                        <input id="reset-answer" type="text"
                                               name="answer" value="" class="input-field"
                                               data-formvalidation-input
                                               data-formvalidation-required="true">
                                    </div><!-- /.form-field -->
                                </div>

                                <div class="btn-controls">
                                    <button class="btn-primary" data-spinnerbutton>{% trans %} reset-password.submit-button {% endtrans %}</button>
                                </div><!-- /.btn-controls -->
                            </form><!-- /.form-security-password-edit -->
                        {% endif %}
                    </section><!-- /#profile-security-password-edit -->
                </div>
            </div><!-- /.page-content -->
        </div><!-- /.hero-wrap -->
    </section><!-- /.page-content -->
</article><!-- /.page -->
{% endblock %}
