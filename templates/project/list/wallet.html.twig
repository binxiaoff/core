{% extends 'layouts/_page_with_sidebar.html.twig' %}

{% block dashboardContent %}
    <section class="dashboard-tabs tabs">
        {% if projects|length > 1 %}
            <div class="dashboard-tabs-nav">
                <ul class="nav nav-dashboard-tabs">
                    {% if projects.borrowerSubmitter is defined %}
                        {% if active is not defined %}
                            {% set active = 'borrowerSubmitter' %}
                        {% endif %}
                        <li role="presentation"
                            {% if active == 'borrowerSubmitter' %} class="active"{% endif %}
                            title="Dossiers que vous avez déposé" data-toggle="tooltip" data-placement="bottom"
                            data-equal-width>
                            <a href="#tab-borrowerSubmitter" role="tab" data-toggle="tab">Dépôts</a>
                        </li>
                    {% endif %}
                    {% if projects.arrangerRun is defined %}
                        {% if active is not defined %}
                            {% set active = 'arrangerRun' %}
                        {% endif %}
                        <li role="presentation"
                            {% if active == 'arrangerRun' %} class="active"{% endif %}
                            title="Dossiers sur lesquels vous intervenez en tant qu‘arrangeur ou RUN" data-toggle="tooltip" data-placement="bottom"
                            data-equal-width>
                            <a href="#tab-arrangerRun" role="tab" data-toggle="tab">Arrangements et notations</a>
                        </li>
                    {% endif %}
                    {% if projects.lender is defined %}
                        {% if active is not defined %}
                            {% set active = 'lender' %}
                        {% endif %}
                        <li role="presentation"
                            {% if active == 'lender' %} class="active"{% endif %}
                            title="Dossiers sur lesquels vous avez fait au moins une offre de participation" data-toggle="tooltip" data-placement="bottom"
                            data-equal-width>
                            <a href="#tab-lender" role="tab" data-toggle="tab">Souscriptions</a>
                        </li>
                    {% endif %}
                </ul>
            </div><!-- /.dashboard-tabs-nav -->
        {% endif %}

        <div class="dashboard-tabs-content tab-content">
            {% if projects.borrowerSubmitter is defined %}
                {% include 'project/list/partials/projects.html.twig' with {'projectsType': 'borrowerSubmitter', 'active': active|default('submitter')} %}
            {% endif %}
            {% if projects.arrangerRun is defined %}
                {% include 'project/list/partials/projects.html.twig' with {'projectsType': 'arrangerRun', 'active': active|default('arrangerRun')} %}
            {% endif %}
            {% if projects.lender is defined %}
                {% include 'project/list/partials/lender.html.twig' with {'active': active|default('lender')} %}
            {% endif %}
        </div><!-- /.dashboard-tabs-content -->
    </section><!-- /.dashboard-tabs -->
{% endblock %}

{% block pageHeadScripts %}
    <style>
        .bubble {
            display: inline-block;
            border-radius: 12px;
            padding: 0 10px;
            line-height: 18px;
            color: #fbf9fb;
            font-weight: 900;
        }

        [data-row-url] {
            cursor: pointer;
        }
    </style>
{% endblock %}

{% block pageScripts %}
    <script>
        $(function () {
            $('[data-row-url]').on('click', function (event) {
                if ($(event.target).is('a')) {
                    return
                }

                var $row = $(this)
                window.location.href = $row.attr('data-row-url')
            })
        })
    </script>
{% endblock %}
